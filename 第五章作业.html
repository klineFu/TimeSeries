<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 第五章作业 | 时间序列作业</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
set in the _output.yml file.
The HTML output format for this example is bookdown::gitbook,</p>" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 第五章作业 | 时间序列作业" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
set in the _output.yml file.
The HTML output format for this example is bookdown::gitbook,</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 第五章作业 | 时间序列作业" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
set in the _output.yml file.
The HTML output format for this example is bookdown::gitbook,</p>" />
  

<meta name="author" content="思想先进的猫猫" />


<meta name="date" content="2023-05-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="第四章作业.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A 思想先进的猫猫</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="chapter" data-level="1" data-path="第一章作业.html"><a href="第一章作业.html"><i class="fa fa-check"></i><b>1</b> 第一章作业</a>
<ul>
<li class="chapter" data-level="1.1" data-path="第一章作业.html"><a href="第一章作业.html#复现课本图像"><i class="fa fa-check"></i><b>1.1</b> 复现课本图像</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="第一章作业.html"><a href="第一章作业.html#强生公司季度收益序列"><i class="fa fa-check"></i><b>1.1.1</b> 强生公司季度收益序列</a></li>
<li class="chapter" data-level="1.1.2" data-path="第一章作业.html"><a href="第一章作业.html#全球变暖和气候变化"><i class="fa fa-check"></i><b>1.1.2</b> 全球变暖和气候变化</a></li>
<li class="chapter" data-level="1.1.3" data-path="第一章作业.html"><a href="第一章作业.html#道琼斯工业平均指数"><i class="fa fa-check"></i><b>1.1.3</b> 道琼斯工业平均指数</a></li>
<li class="chapter" data-level="1.1.4" data-path="第一章作业.html"><a href="第一章作业.html#美国gdp对数增长率与实际增长率"><i class="fa fa-check"></i><b>1.1.4</b> 美国GDP对数增长率与实际增长率</a></li>
<li class="chapter" data-level="1.1.5" data-path="第一章作业.html"><a href="第一章作业.html#厄尔尼诺南方涛动enso"><i class="fa fa-check"></i><b>1.1.5</b> 厄尔尼诺—南方涛动（ENSO）</a></li>
<li class="chapter" data-level="1.1.6" data-path="第一章作业.html"><a href="第一章作业.html#捕食者与猎物的互动"><i class="fa fa-check"></i><b>1.1.6</b> 捕食者与猎物的互动</a></li>
<li class="chapter" data-level="1.1.7" data-path="第一章作业.html"><a href="第一章作业.html#fmri图像"><i class="fa fa-check"></i><b>1.1.7</b> fMRI图像</a></li>
<li class="chapter" data-level="1.1.8" data-path="第一章作业.html"><a href="第一章作业.html#滤波序列"><i class="fa fa-check"></i><b>1.1.8</b> 滤波序列</a></li>
<li class="chapter" data-level="1.1.9" data-path="第一章作业.html"><a href="第一章作业.html#自回归模型"><i class="fa fa-check"></i><b>1.1.9</b> 自回归模型</a></li>
<li class="chapter" data-level="1.1.10" data-path="第一章作业.html"><a href="第一章作业.html#带漂移项的随机游走序列"><i class="fa fa-check"></i><b>1.1.10</b> 带漂移项的随机游走序列</a></li>
<li class="chapter" data-level="1.1.11" data-path="第一章作业.html"><a href="第一章作业.html#信号与噪声"><i class="fa fa-check"></i><b>1.1.11</b> 信号与噪声</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="第一章作业.html"><a href="第一章作业.html#随机数的产生"><i class="fa fa-check"></i><b>1.2</b> 随机数的产生</a></li>
<li class="chapter" data-level="1.3" data-path="第一章作业.html"><a href="第一章作业.html#课后习题"><i class="fa fa-check"></i><b>1.3</b> 课后习题</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="第一章作业.html"><a href="第一章作业.html#习题1.1"><i class="fa fa-check"></i><b>1.3.1</b> 习题1.1</a></li>
<li class="chapter" data-level="1.3.2" data-path="第一章作业.html"><a href="第一章作业.html#习题1.2"><i class="fa fa-check"></i><b>1.3.2</b> 习题1.2</a></li>
<li class="chapter" data-level="1.3.3" data-path="第一章作业.html"><a href="第一章作业.html#习题1.3"><i class="fa fa-check"></i><b>1.3.3</b> 习题1.3</a></li>
<li class="chapter" data-level="1.3.4" data-path="第一章作业.html"><a href="第一章作业.html#习题1.4"><i class="fa fa-check"></i><b>1.3.4</b> 习题1.4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="第二章作业.html"><a href="第二章作业.html"><i class="fa fa-check"></i><b>2</b> 第二章作业</a>
<ul>
<li class="chapter" data-level="" data-path="第二章作业.html"><a href="第二章作业.html#libs"><i class="fa fa-check"></i>Libs</a></li>
<li class="chapter" data-level="2.1" data-path="第二章作业.html"><a href="第二章作业.html#高斯白噪声序列"><i class="fa fa-check"></i><b>2.1</b> 2.11 高斯白噪声序列</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="第二章作业.html"><a href="第二章作业.html#a"><i class="fa fa-check"></i><b>2.1.1</b> 2.11 (a)</a></li>
<li class="chapter" data-level="2.1.2" data-path="第二章作业.html"><a href="第二章作业.html#b"><i class="fa fa-check"></i><b>2.1.2</b> 2.11 (b)</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="第二章作业.html"><a href="第二章作业.html#移动平均序列"><i class="fa fa-check"></i><b>2.2</b> 2.12 移动平均序列</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="第二章作业.html"><a href="第二章作业.html#a-1"><i class="fa fa-check"></i><b>2.2.1</b> 2.12 (a)</a></li>
<li class="chapter" data-level="2.2.2" data-path="第二章作业.html"><a href="第二章作业.html#b-1"><i class="fa fa-check"></i><b>2.2.2</b> 2.12 (b)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="第二章作业.html"><a href="第二章作业.html#ar模型"><i class="fa fa-check"></i><b>2.3</b> 2.13 AR模型</a></li>
<li class="chapter" data-level="2.4" data-path="第二章作业.html"><a href="第二章作业.html#信号加噪声模型"><i class="fa fa-check"></i><b>2.4</b> 2.14 信号加噪声模型</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="第三章作业.html"><a href="第三章作业.html"><i class="fa fa-check"></i><b>3</b> 第三章作业</a>
<ul>
<li class="chapter" data-level="" data-path="第三章作业.html"><a href="第三章作业.html#libs-1"><i class="fa fa-check"></i>Libs</a></li>
<li class="chapter" data-level="3.1" data-path="第三章作业.html"><a href="第三章作业.html#结构回归模型"><i class="fa fa-check"></i><b>3.1</b> 3.1 结构回归模型</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="第三章作业.html"><a href="第三章作业.html#a-2"><i class="fa fa-check"></i><b>3.1.1</b> 3.1 (a)</a></li>
<li class="chapter" data-level="3.1.2" data-path="第三章作业.html"><a href="第三章作业.html#b-2"><i class="fa fa-check"></i><b>3.1.2</b> 3.1 (b)</a></li>
<li class="chapter" data-level="3.1.3" data-path="第三章作业.html"><a href="第三章作业.html#c"><i class="fa fa-check"></i><b>3.1.3</b> 3.1 (c)</a></li>
<li class="chapter" data-level="3.1.4" data-path="第三章作业.html"><a href="第三章作业.html#d"><i class="fa fa-check"></i><b>3.1.4</b> 3.1 (d)</a></li>
<li class="chapter" data-level="3.1.5" data-path="第三章作业.html"><a href="第三章作业.html#e"><i class="fa fa-check"></i><b>3.1.5</b> 3.1 (e)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="第三章作业.html"><a href="第三章作业.html#检验的死亡率数据"><i class="fa fa-check"></i><b>3.2</b> 3.2 检验的死亡率数据</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="第三章作业.html"><a href="第三章作业.html#a-3"><i class="fa fa-check"></i><b>3.2.1</b> 3.2 (a)</a></li>
<li class="chapter" data-level="3.2.2" data-path="第三章作业.html"><a href="第三章作业.html#b-3"><i class="fa fa-check"></i><b>3.2.2</b> 3.2 (b)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="第三章作业.html"><a href="第三章作业.html#随机游走和趋势平稳过程之间的区别"><i class="fa fa-check"></i><b>3.3</b> 3.3 随机游走和趋势平稳过程之间的区别</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="第三章作业.html"><a href="第三章作业.html#a-4"><i class="fa fa-check"></i><b>3.3.1</b> 3.3 (a)</a></li>
<li class="chapter" data-level="3.3.2" data-path="第三章作业.html"><a href="第三章作业.html#b-4"><i class="fa fa-check"></i><b>3.3.2</b> 3.3 (b)</a></li>
<li class="chapter" data-level="3.3.3" data-path="第三章作业.html"><a href="第三章作业.html#c-1"><i class="fa fa-check"></i><b>3.3.3</b> 3.3 (c)</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="第三章作业.html"><a href="第三章作业.html#线性趋势组成的过程"><i class="fa fa-check"></i><b>3.4</b> 3.4 线性趋势组成的过程</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="第三章作业.html"><a href="第三章作业.html#a-5"><i class="fa fa-check"></i><b>3.4.1</b> 3.4 (a)</a></li>
<li class="chapter" data-level="3.4.2" data-path="第三章作业.html"><a href="第三章作业.html#b-5"><i class="fa fa-check"></i><b>3.4.2</b> 3.4 (b)</a></li>
<li class="chapter" data-level="3.4.3" data-path="第三章作业.html"><a href="第三章作业.html#c-2"><i class="fa fa-check"></i><b>3.4.3</b> 3.4 (c)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="第三章作业.html"><a href="第三章作业.html#平稳性证明"><i class="fa fa-check"></i><b>3.5</b> 3.5 平稳性证明</a></li>
<li class="chapter" data-level="3.6" data-path="第三章作业.html"><a href="第三章作业.html#冰川纹层数据"><i class="fa fa-check"></i><b>3.6</b> 3.6 冰川纹层数据</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="第三章作业.html"><a href="第三章作业.html#a-6"><i class="fa fa-check"></i><b>3.6.1</b> 3.6 (a)</a></li>
<li class="chapter" data-level="3.6.2" data-path="第三章作业.html"><a href="第三章作业.html#b-6"><i class="fa fa-check"></i><b>3.6.2</b> 3.6 (b)</a></li>
<li class="chapter" data-level="3.6.3" data-path="第三章作业.html"><a href="第三章作业.html#c-3"><i class="fa fa-check"></i><b>3.6.3</b> 3.6 (c)</a></li>
<li class="chapter" data-level="3.6.4" data-path="第三章作业.html"><a href="第三章作业.html#d-1"><i class="fa fa-check"></i><b>3.6.4</b> 3.6 (d)</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="第三章作业.html"><a href="第三章作业.html#全球温度序列"><i class="fa fa-check"></i><b>3.7</b> 3.7 全球温度序列</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="第三章作业.html"><a href="第三章作业.html#移动平均平滑器"><i class="fa fa-check"></i><b>3.7.1</b> 3.7 移动平均平滑器</a></li>
<li class="chapter" data-level="3.7.2" data-path="第三章作业.html"><a href="第三章作业.html#核平滑"><i class="fa fa-check"></i><b>3.7.2</b> 3.7 核平滑</a></li>
<li class="chapter" data-level="3.7.3" data-path="第三章作业.html"><a href="第三章作业.html#lowess"><i class="fa fa-check"></i><b>3.7.3</b> 3.7 lowess</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="第三章作业.html"><a href="第三章作业.html#厄尔尼诺现象"><i class="fa fa-check"></i><b>3.8</b> 3.8 厄尔尼诺现象</a></li>
<li class="chapter" data-level="3.9" data-path="第三章作业.html"><a href="第三章作业.html#强生公司数据序列"><i class="fa fa-check"></i><b>3.9</b> 3.9 强生公司数据序列</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="第四章作业.html"><a href="第四章作业.html"><i class="fa fa-check"></i><b>4</b> 第四章作业</a>
<ul>
<li class="chapter" data-level="" data-path="第四章作业.html"><a href="第四章作业.html#libs-2"><i class="fa fa-check"></i>Libs</a></li>
<li class="chapter" data-level="4.1" data-path="第四章作业.html"><a href="第四章作业.html#ma1的acf"><i class="fa fa-check"></i><b>4.1</b> 4.1 MA(1)的ACF</a></li>
<li class="chapter" data-level="4.2" data-path="第四章作业.html"><a href="第四章作业.html#白噪声过程"><i class="fa fa-check"></i><b>4.2</b> 4.2 白噪声过程</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="第四章作业.html"><a href="第四章作业.html#a-7"><i class="fa fa-check"></i><b>4.2.1</b> (a)</a></li>
<li class="chapter" data-level="4.2.2" data-path="第四章作业.html"><a href="第四章作业.html#b-7"><i class="fa fa-check"></i><b>4.2.2</b> (b)</a></li>
<li class="chapter" data-level="4.2.3" data-path="第四章作业.html"><a href="第四章作业.html#c-4"><i class="fa fa-check"></i><b>4.2.3</b> (c)</a></li>
<li class="chapter" data-level="4.2.4" data-path="第四章作业.html"><a href="第四章作业.html#d-2"><i class="fa fa-check"></i><b>4.2.4</b> (d)</a></li>
<li class="chapter" data-level="4.2.5" data-path="第四章作业.html"><a href="第四章作业.html#e-1"><i class="fa fa-check"></i><b>4.2.5</b> (e)</a></li>
<li class="chapter" data-level="4.2.6" data-path="第四章作业.html"><a href="第四章作业.html#f"><i class="fa fa-check"></i><b>4.2.6</b> (f)</a></li>
<li class="chapter" data-level="4.2.7" data-path="第四章作业.html"><a href="第四章作业.html#g"><i class="fa fa-check"></i><b>4.2.7</b> (g)</a></li>
<li class="chapter" data-level="4.2.8" data-path="第四章作业.html"><a href="第四章作业.html#h"><i class="fa fa-check"></i><b>4.2.8</b> (h)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="第四章作业.html"><a href="第四章作业.html#参数冗余的讨论"><i class="fa fa-check"></i><b>4.3</b> 4.3 参数冗余的讨论</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="第四章作业.html"><a href="第四章作业.html#a-8"><i class="fa fa-check"></i><b>4.3.1</b> (a)</a></li>
<li class="chapter" data-level="4.3.2" data-path="第四章作业.html"><a href="第四章作业.html#b-8"><i class="fa fa-check"></i><b>4.3.2</b> (b)</a></li>
<li class="chapter" data-level="4.3.3" data-path="第四章作业.html"><a href="第四章作业.html#c-5"><i class="fa fa-check"></i><b>4.3.3</b> (c)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="第四章作业.html"><a href="第四章作业.html#三个arma模型"><i class="fa fa-check"></i><b>4.4</b> 4.4 三个ARMA模型</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="第四章作业.html"><a href="第四章作业.html#a-9"><i class="fa fa-check"></i><b>4.4.1</b> (a)</a></li>
<li class="chapter" data-level="4.4.2" data-path="第四章作业.html"><a href="第四章作业.html#b-9"><i class="fa fa-check"></i><b>4.4.2</b> (b)</a></li>
<li class="chapter" data-level="4.4.3" data-path="第四章作业.html"><a href="第四章作业.html#c-6"><i class="fa fa-check"></i><b>4.4.3</b> (c)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="第四章作业.html"><a href="第四章作业.html#cmort数据分析"><i class="fa fa-check"></i><b>4.5</b> 4.5 cmort数据分析</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="第四章作业.html"><a href="第四章作业.html#a-10"><i class="fa fa-check"></i><b>4.5.1</b> (a)</a></li>
<li class="chapter" data-level="4.5.2" data-path="第四章作业.html"><a href="第四章作业.html#b-10"><i class="fa fa-check"></i><b>4.5.2</b> (b)</a></li>
<li class="chapter" data-level="4.5.3" data-path="第四章作业.html"><a href="第四章作业.html#c-7"><i class="fa fa-check"></i><b>4.5.3</b> (c)</a></li>
<li class="chapter" data-level="4.5.4" data-path="第四章作业.html"><a href="第四章作业.html#d-3"><i class="fa fa-check"></i><b>4.5.4</b> (d)</a></li>
<li class="chapter" data-level="4.5.5" data-path="第四章作业.html"><a href="第四章作业.html#e-2"><i class="fa fa-check"></i><b>4.5.5</b> (e)</a></li>
<li class="chapter" data-level="4.5.6" data-path="第四章作业.html"><a href="第四章作业.html#f-1"><i class="fa fa-check"></i><b>4.5.6</b> (f)</a></li>
<li class="chapter" data-level="4.5.7" data-path="第四章作业.html"><a href="第四章作业.html#g-1"><i class="fa fa-check"></i><b>4.5.7</b> (g)</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="第四章作业.html"><a href="第四章作业.html#模型预测与mspe"><i class="fa fa-check"></i><b>4.6</b> 4.6 模型预测与MSPE</a></li>
<li class="chapter" data-level="4.7" data-path="第四章作业.html"><a href="第四章作业.html#参数估计"><i class="fa fa-check"></i><b>4.7</b> 4.7 参数估计</a></li>
<li class="chapter" data-level="4.8" data-path="第四章作业.html"><a href="第四章作业.html#参数的mle"><i class="fa fa-check"></i><b>4.8</b> 4.8 参数的MLE</a></li>
<li class="chapter" data-level="4.9" data-path="第四章作业.html"><a href="第四章作业.html#ar1的高斯-牛顿算法"><i class="fa fa-check"></i><b>4.9</b> 4.9 AR(1)的高斯-牛顿算法</a></li>
<li class="chapter" data-level="4.10" data-path="第四章作业.html"><a href="第四章作业.html#预测误差"><i class="fa fa-check"></i><b>4.10</b> 4.10 预测误差</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="第五章作业.html"><a href="第五章作业.html"><i class="fa fa-check"></i><b>5</b> 第五章作业</a>
<ul>
<li class="chapter" data-level="" data-path="第五章作业.html"><a href="第五章作业.html#libs-3"><i class="fa fa-check"></i>Libs</a></li>
<li class="chapter" data-level="5.1" data-path="第五章作业.html"><a href="第五章作业.html#冰川纹层数据与ewma"><i class="fa fa-check"></i><b>5.1</b> 5.1 冰川纹层数据与EWMA</a></li>
<li class="chapter" data-level="5.2" data-path="第五章作业.html"><a href="第五章作业.html#美国gdp序列分析"><i class="fa fa-check"></i><b>5.2</b> 5.2 美国GDP序列分析</a></li>
<li class="chapter" data-level="5.3" data-path="第五章作业.html"><a href="第五章作业.html#原油数据分析"><i class="fa fa-check"></i><b>5.3</b> 5.3 原油数据分析</a></li>
<li class="chapter" data-level="5.4" data-path="第五章作业.html"><a href="第五章作业.html#陆地温度数据"><i class="fa fa-check"></i><b>5.4</b> 5.4 陆地温度数据</a></li>
<li class="chapter" data-level="5.5" data-path="第五章作业.html"><a href="第五章作业.html#海洋温度数据"><i class="fa fa-check"></i><b>5.5</b> 5.5 海洋温度数据</a></li>
<li class="chapter" data-level="5.6" data-path="第五章作业.html"><a href="第五章作业.html#二氧化硫序列"><i class="fa fa-check"></i><b>5.6</b> 5.6 二氧化硫序列</a></li>
<li class="chapter" data-level="5.7" data-path="第五章作业.html"><a href="第五章作业.html#国际航班乘客数据"><i class="fa fa-check"></i><b>5.7</b> 5.7 国际航班乘客数据</a></li>
<li class="chapter" data-level="5.8" data-path="第五章作业.html"><a href="第五章作业.html#季节性arima模型acf的绘制"><i class="fa fa-check"></i><b>5.8</b> 5.8 季节性ARIMA模型ACF的绘制</a></li>
<li class="chapter" data-level="5.9" data-path="第五章作业.html"><a href="第五章作业.html#鸡肉价格数据"><i class="fa fa-check"></i><b>5.9</b> 5.9 鸡肉价格数据</a></li>
<li class="chapter" data-level="5.10" data-path="第五章作业.html"><a href="第五章作业.html#失业数据"><i class="fa fa-check"></i><b>5.10</b> 5.10 失业数据</a></li>
<li class="chapter" data-level="5.11" data-path="第五章作业.html"><a href="第五章作业.html#美国出生数据"><i class="fa fa-check"></i><b>5.11</b> 5.11 美国出生数据</a></li>
<li class="chapter" data-level="5.12" data-path="第五章作业.html"><a href="第五章作业.html#强生公司收益率"><i class="fa fa-check"></i><b>5.12</b> 5.12 强生公司收益率</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">时间序列作业</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="第五章作业" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> 第五章作业<a href="第五章作业.html#第五章作业" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="libs-3" class="section level2 unnumbered hasAnchor">
<h2>Libs<a href="第五章作业.html#libs-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="第五章作业.html#cb144-1" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(astsa,tidyverse,ggplot2,reshape2,forecast,grid)</span></code></pre></div>
</div>
<div id="冰川纹层数据与ewma" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> 5.1 冰川纹层数据与EWMA<a href="第五章作业.html#冰川纹层数据与ewma" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在<span class="math inline">\(\lambda=0.25,0.50,0.75\)</span>的不同情况下计算EWMA，并且在同一图形上绘制EWMA和时间数据数据：</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="第五章作业.html#cb145-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">log</span>(varve[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>])</span>
<span id="cb145-2"><a href="第五章作业.html#cb145-2" tabindex="-1"></a>x25 <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(x, <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">beta =</span> <span class="cn">FALSE</span>, <span class="at">gamma =</span> <span class="cn">FALSE</span>)</span>
<span id="cb145-3"><a href="第五章作业.html#cb145-3" tabindex="-1"></a>x50 <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(x, <span class="at">alpha =</span> <span class="fl">0.50</span>, <span class="at">beta =</span> <span class="cn">FALSE</span>, <span class="at">gamma =</span> <span class="cn">FALSE</span>)</span>
<span id="cb145-4"><a href="第五章作业.html#cb145-4" tabindex="-1"></a>x75 <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(x, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">beta =</span> <span class="cn">FALSE</span>, <span class="at">gamma =</span> <span class="cn">FALSE</span>)</span>
<span id="cb145-5"><a href="第五章作业.html#cb145-5" tabindex="-1"></a></span>
<span id="cb145-6"><a href="第五章作业.html#cb145-6" tabindex="-1"></a>x25_fit <span class="ot">&lt;-</span> x25<span class="sc">$</span>fit[, <span class="dv">1</span>]</span>
<span id="cb145-7"><a href="第五章作业.html#cb145-7" tabindex="-1"></a>x50_fit <span class="ot">&lt;-</span> x50<span class="sc">$</span>fit[, <span class="dv">1</span>]</span>
<span id="cb145-8"><a href="第五章作业.html#cb145-8" tabindex="-1"></a>x75_fit <span class="ot">&lt;-</span> x75<span class="sc">$</span>fit[, <span class="dv">1</span>]</span>
<span id="cb145-9"><a href="第五章作业.html#cb145-9" tabindex="-1"></a></span>
<span id="cb145-10"><a href="第五章作业.html#cb145-10" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb145-11"><a href="第五章作业.html#cb145-11" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq_along</span>(x)[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb145-12"><a href="第五章作业.html#cb145-12" tabindex="-1"></a>  <span class="at">y =</span> x[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb145-13"><a href="第五章作业.html#cb145-13" tabindex="-1"></a>  <span class="at">x25 =</span> x25_fit,</span>
<span id="cb145-14"><a href="第五章作业.html#cb145-14" tabindex="-1"></a>  <span class="at">x50 =</span> x50_fit,</span>
<span id="cb145-15"><a href="第五章作业.html#cb145-15" tabindex="-1"></a>  <span class="at">x75 =</span> x75_fit</span>
<span id="cb145-16"><a href="第五章作业.html#cb145-16" tabindex="-1"></a>)</span>
<span id="cb145-17"><a href="第五章作业.html#cb145-17" tabindex="-1"></a></span>
<span id="cb145-18"><a href="第五章作业.html#cb145-18" tabindex="-1"></a></span>
<span id="cb145-19"><a href="第五章作业.html#cb145-19" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb145-20"><a href="第五章作业.html#cb145-20" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb145-21"><a href="第五章作业.html#cb145-21" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">color =</span> <span class="st">&quot;Original Data&quot;</span> ))<span class="sc">+</span></span>
<span id="cb145-22"><a href="第五章作业.html#cb145-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> x25, <span class="at">color =</span> <span class="st">&quot;0.25&quot;</span>), <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="sc">+</span></span>
<span id="cb145-23"><a href="第五章作业.html#cb145-23" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> x50, <span class="at">color =</span> <span class="st">&quot;0.50&quot;</span>), <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="sc">+</span></span>
<span id="cb145-24"><a href="第五章作业.html#cb145-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> x75, <span class="at">color =</span> <span class="st">&quot;0.75&quot;</span>), <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="sc">+</span></span>
<span id="cb145-25"><a href="第五章作业.html#cb145-25" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">ylab =</span> <span class="st">&quot;log(varve)&quot;</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
</div>
<div id="美国gdp序列分析" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> 5.2 美国GDP序列分析<a href="第五章作业.html#美国gdp序列分析" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>首先，绘制GDP时间序列的时序图以及ACF和PACF：</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="第五章作业.html#cb146-1" tabindex="-1"></a><span class="fu">layout</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">heights=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb146-2"><a href="第五章作业.html#cb146-2" tabindex="-1"></a><span class="fu">tsplot</span>(gdp, <span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb146-3"><a href="第五章作业.html#cb146-3" tabindex="-1"></a><span class="fu">acf2</span>(gdp)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-77-1.png" width="672" /><img src="_main_files/figure-html/unnamed-chunk-77-2.png" width="672" /></p>
<pre><code>##      [,1] [,2] [,3]  [,4] [,5] [,6] [,7]  [,8]  [,9] [,10] [,11] [,12] [,13]
## ACF  0.99 0.98 0.97  0.96 0.95 0.94 0.93  0.92  0.91  0.90  0.89  0.88  0.87
## PACF 0.99 0.00 0.00 -0.01 0.00 0.00 0.00 -0.01 -0.01 -0.01 -0.01 -0.01 -0.01
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
## ACF   0.86  0.85  0.84  0.83  0.82  0.81  0.80  0.79  0.78  0.77  0.76  0.75
## PACF -0.01  0.00  0.00 -0.01  0.00  0.00 -0.02  0.00  0.00 -0.01  0.00 -0.01
##      [,26] [,27]
## ACF   0.74  0.73
## PACF -0.01 -0.01</code></pre>
<p>由于GDP数据具有明显的趋势性因此对数据进行一次差分，差分后再次绘制时序图：</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="第五章作业.html#cb148-1" tabindex="-1"></a><span class="fu">dev.new</span>()</span>
<span id="cb148-2"><a href="第五章作业.html#cb148-2" tabindex="-1"></a><span class="fu">tsplot</span>(<span class="fu">diff</span>(<span class="fu">log</span>(gdp)), <span class="at">ylab=</span><span class="st">&quot;GNP Growth Rate&quot;</span>, <span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb148-3"><a href="第五章作业.html#cb148-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">mean</span>(<span class="fu">diff</span>(<span class="fu">log</span>(gdp))), <span class="at">col=</span><span class="dv">6</span>)</span></code></pre></div>
<p>对于差分后的数据，绘制其ACF与PACF：</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="第五章作业.html#cb149-1" tabindex="-1"></a><span class="fu">dev.new</span>()</span>
<span id="cb149-2"><a href="第五章作业.html#cb149-2" tabindex="-1"></a><span class="fu">acf2</span>(<span class="fu">diff</span>(<span class="fu">log</span>(gdp)), <span class="at">main=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8] [,9] [,10] [,11] [,12] [,13]
## ACF  0.36 0.23  0.02 -0.06 -0.13 -0.03 -0.04 -0.01 0.08  0.10  0.02 -0.11 -0.11
## PACF 0.36 0.11 -0.11 -0.07 -0.08  0.07 -0.02 -0.02 0.10  0.04 -0.07 -0.16 -0.02
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
## ACF  -0.05 -0.08  0.05  0.05  0.11  0.07  0.07 -0.07 -0.05 -0.09 -0.02  0.03
## PACF  0.08 -0.06  0.08  0.01  0.06 -0.02 -0.01 -0.07  0.03 -0.04  0.03  0.05
##      [,26] [,27]
## ACF   0.03  0.06
## PACF -0.04  0.03</code></pre>
<p>对数据拟合不同的模型，观察不同模型的拟合情况：</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="第五章作业.html#cb151-1" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb151-2"><a href="第五章作业.html#cb151-2" tabindex="-1"></a><span class="fu">sarima</span>(<span class="fu">diff</span>(<span class="fu">log</span>(gdp)), <span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># AR(3) on growth rate</span></span></code></pre></div>
<pre><code>## initial  value -4.672826 
## iter   2 value -4.735845
## iter   3 value -4.756484
## iter   4 value -4.756533
## iter   5 value -4.756533
## iter   6 value -4.756533
## iter   6 value -4.756533
## iter   6 value -4.756533
## final  value -4.756533 
## converged
## initial  value -4.754958 
## iter   2 value -4.754969
## iter   3 value -4.754970
## iter   4 value -4.754973
## iter   5 value -4.754973
## iter   5 value -4.754973
## iter   5 value -4.754973
## final  value -4.754973 
## converged</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
##     xreg = xmean, include.mean = FALSE, transform.pars = trans, fixed = fixed, 
##     optim.control = list(trace = trc, REPORT = 1, reltol = tol))
## 
## Coefficients:
##          ar1     ar2      ar3   xmean
##       0.3331  0.1489  -0.1122  0.0077
## s.e.  0.0587  0.0613   0.0588  0.0008
## 
## sigma^2 estimated as 7.406e-05:  log likelihood = 954.11,  aic = -1898.21
## 
## $degrees_of_freedom
## [1] 282
## 
## $ttable
##       Estimate     SE t.value p.value
## ar1     0.3331 0.0587  5.6759  0.0000
## ar2     0.1489 0.0613  2.4283  0.0158
## ar3    -0.1122 0.0588 -1.9069  0.0575
## xmean   0.0077 0.0008  9.5617  0.0000
## 
## $AIC
## [1] -6.637105
## 
## $AICc
## [1] -6.636607
## 
## $BIC
## [1] -6.573189</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="第五章作业.html#cb154-1" tabindex="-1"></a><span class="fu">sarima</span>(<span class="fu">diff</span>(<span class="fu">log</span>(gdp)), <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="co"># MA(1) on growth rate</span></span></code></pre></div>
<pre><code>## initial  value -4.672758 
## iter   2 value -4.716609
## iter   3 value -4.723220
## iter   4 value -4.723481
## iter   5 value -4.723483
## iter   5 value -4.723483
## iter   5 value -4.723483
## final  value -4.723483 
## converged
## initial  value -4.723444 
## iter   1 value -4.723444
## final  value -4.723444 
## converged</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-80-2.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
##     xreg = xmean, include.mean = FALSE, transform.pars = trans, fixed = fixed, 
##     optim.control = list(trace = trc, REPORT = 1, reltol = tol))
## 
## Coefficients:
##          ma1   xmean
##       0.2687  0.0077
## s.e.  0.0470  0.0007
## 
## sigma^2 estimated as 7.891e-05:  log likelihood = 945.09,  aic = -1884.18
## 
## $degrees_of_freedom
## [1] 284
## 
## $ttable
##       Estimate     SE t.value p.value
## ma1     0.2687 0.0470  5.7155       0
## xmean   0.0077 0.0007 11.5865       0
## 
## $AIC
## [1] -6.588031
## 
## $AICc
## [1] -6.587883
## 
## $BIC
## [1] -6.549682</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="第五章作业.html#cb157-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">ARMAtoMA</span>(<span class="at">ar=</span>.<span class="dv">33</span>, <span class="at">ma=</span><span class="dv">0</span>, <span class="dv">10</span>), <span class="dv">3</span>) <span class="co"># print psi-weights</span></span></code></pre></div>
<pre><code>##  [1] 0.330 0.109 0.036 0.012 0.004 0.001 0.000 0.000 0.000 0.000</code></pre>
<ul>
<li><p>从Ljung-Box统计量的检验结果来看，AR(3)模型也具有较好的残差性质。</p></li>
<li><p>从AIC，AICc，BIC的角度看（越小越好），因此更加倾向于AR(3)模型。</p></li>
</ul>
<p>因此，综合考虑起来，对于差分后的数据选择模型AR(3)，那么对于原始数据，选择的模型为ARIMA(3,1,0)。</p>
</div>
<div id="原油数据分析" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> 5.3 原油数据分析<a href="第五章作业.html#原油数据分析" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>绘制时间序列的时序图，由于数据具有趋势性，考虑进行一次差分，差分后数据不再具有明显的趋势性。</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="第五章作业.html#cb159-1" tabindex="-1"></a><span class="fu">tsplot</span>(oil)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="第五章作业.html#cb160-1" tabindex="-1"></a><span class="fu">tsplot</span>(<span class="fu">diff</span>(oil))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-81-2.png" width="672" /></p>
<p>其次，确定模型的阶数，按照题目要求，无需拟合含季节项的ARIMA模型：</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="第五章作业.html#cb161-1" tabindex="-1"></a><span class="fu">auto.arima</span>(oil,<span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Series: oil 
## ARIMA(1,1,2) 
## 
## Coefficients:
##          ar1      ma1      ma2
##       0.8943  -0.7337  -0.0724
## s.e.  0.0483   0.0658   0.0465
## 
## sigma^2 = 6.431:  log likelihood = -1276.68
## AIC=2561.35   AICc=2561.43   BIC=2578.55</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="第五章作业.html#cb163-1" tabindex="-1"></a><span class="fu">acf2</span>(<span class="fu">diff</span>(oil))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]
## ACF  0.18 0.06 0.11 0.05 0.08 0.04 0.03 0.19 0.09  0.07  0.08  0.04 -0.04  0.05
## PACF 0.18 0.03 0.10 0.02 0.06 0.01 0.01 0.18 0.02  0.04  0.02  0.01 -0.09  0.05
##      [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26]
## ACF   0.00 -0.07  0.02  0.06 -0.04 -0.08 -0.08  0.03 -0.07 -0.08 -0.13 -0.02
## PACF -0.03 -0.10  0.03  0.04 -0.07 -0.09 -0.03  0.05 -0.07 -0.01 -0.12  0.02
##      [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37] [,38]
## ACF  -0.15 -0.09  0.01 -0.05 -0.06 -0.07 -0.06 -0.01 -0.14 -0.01 -0.02 -0.02
## PACF -0.13  0.01  0.05 -0.02  0.00 -0.05  0.02  0.02 -0.08  0.05 -0.01  0.04
##      [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48] [,49] [,50]
## ACF   0.00 -0.02 -0.10 -0.08 -0.02  0.02  0.03  0.01  0.04  0.05 -0.02 -0.03
## PACF  0.01 -0.03 -0.11 -0.03  0.03  0.02  0.06 -0.02  0.04 -0.02  0.03 -0.04
##      [,51] [,52] [,53] [,54] [,55] [,56] [,57] [,58] [,59] [,60] [,61] [,62]
## ACF  -0.05 -0.08 -0.04 -0.04  0.03  0.01 -0.13 -0.02 -0.09 -0.01 -0.07  0.03
## PACF -0.08 -0.10 -0.03 -0.05  0.01 -0.01 -0.16  0.01 -0.07  0.05 -0.06  0.07
##      [,63] [,64] [,65] [,66] [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74]
## ACF  -0.01 -0.03 -0.04  0.05  0.02 -0.03 -0.07 -0.01 -0.03 -0.04 -0.01  0.00
## PACF -0.02  0.00 -0.01  0.08  0.02 -0.04 -0.04  0.00 -0.01 -0.04 -0.02 -0.01
##      [,75] [,76] [,77] [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86]
## ACF      0 -0.03  0.00  0.06  0.04  0.01 -0.02 -0.01  0.03  0.03 -0.01  0.03
## PACF     0 -0.06 -0.02  0.03  0.04 -0.01 -0.03 -0.05  0.05 -0.08 -0.01  0.01
##      [,87] [,88] [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98]
## ACF   0.04 -0.02  0.01 -0.02     0  0.06  0.07  0.02  0.04  0.06  0.00  0.01
## PACF  0.05 -0.09 -0.01 -0.01     0 -0.02  0.07 -0.04  0.02  0.03 -0.01 -0.01
##      [,99] [,100] [,101] [,102] [,103] [,104] [,105] [,106] [,107] [,108]
## ACF   0.04   0.05   0.01  -0.01  -0.01   0.03   0.00  -0.01   0.03   0.03
## PACF  0.07   0.02  -0.07   0.00  -0.02   0.00  -0.03   0.03  -0.01   0.03
##      [,109] [,110] [,111] [,112] [,113] [,114] [,115] [,116] [,117] [,118]
## ACF    0.05   0.05   0.06   0.04   0.01   0.01   0.00  -0.02   0.00   0.01
## PACF  -0.01   0.02   0.01   0.05  -0.04   0.01  -0.03  -0.03  -0.04   0.00
##      [,119] [,120] [,121] [,122] [,123] [,124] [,125] [,126] [,127] [,128]
## ACF    0.00   0.01      0   0.04  -0.02  -0.05  -0.07   0.01   0.00  -0.02
## PACF   0.04   0.01      0  -0.01   0.00  -0.02  -0.06   0.00   0.05  -0.03
##      [,129] [,130] [,131] [,132] [,133] [,134] [,135] [,136] [,137] [,138]
## ACF    0.02   0.02  -0.05  -0.01  -0.02  -0.02  -0.04  -0.06  -0.05   0.02
## PACF   0.01   0.01  -0.02   0.00  -0.01   0.02   0.01  -0.03  -0.03   0.02
##      [,139] [,140] [,141] [,142] [,143] [,144] [,145] [,146] [,147] [,148]
## ACF   -0.01   0.01   0.01   0.01  -0.01  -0.01   0.01  -0.01  -0.02      0
## PACF   0.02   0.02  -0.03   0.03  -0.01   0.00   0.00   0.00   0.00      0
##      [,149] [,150] [,151] [,152] [,153] [,154] [,155] [,156] [,157] [,158]
## ACF   -0.01  -0.01   0.01   0.02   0.04   0.01  -0.02   0.03   0.02  -0.02
## PACF  -0.03   0.01   0.02   0.04   0.02   0.05  -0.04   0.02  -0.01  -0.06
##      [,159] [,160] [,161] [,162] [,163] [,164] [,165] [,166] [,167] [,168]
## ACF    0.01   0.04  -0.01   0.03  -0.01  -0.03   0.01  -0.01  -0.02   0.00
## PACF   0.01   0.02  -0.01   0.00   0.01  -0.03   0.03  -0.04   0.02   0.02
##      [,169] [,170] [,171] [,172] [,173] [,174] [,175] [,176] [,177] [,178]
## ACF   -0.02  -0.02  -0.01  -0.02  -0.02   0.03  -0.01  -0.01   0.02   0.02
## PACF   0.03  -0.04   0.00   0.00   0.00   0.00   0.00  -0.01   0.01   0.02
##      [,179] [,180] [,181] [,182] [,183] [,184] [,185] [,186] [,187] [,188]
## ACF   -0.02  -0.04  -0.04   0.05  -0.03  -0.03   0.03  -0.01   0.00   0.02
## PACF  -0.01   0.00   0.02   0.05  -0.05   0.03   0.01  -0.04   0.02   0.02
##      [,189] [,190] [,191] [,192] [,193] [,194] [,195] [,196] [,197] [,198]
## ACF   -0.03  -0.03   0.00   0.02   0.03   0.01   0.00   0.07  -0.01  -0.03
## PACF  -0.06  -0.07   0.02   0.02   0.02   0.02   0.02   0.03  -0.02   0.00
##      [,199] [,200] [,201] [,202] [,203] [,204] [,205] [,206] [,207] [,208]
## ACF    0.01   0.02   0.00   0.00  -0.04   0.00   0.05   0.03   0.04   0.02
## PACF  -0.01  -0.01   0.01  -0.01  -0.04  -0.01   0.05   0.00   0.03   0.00</code></pre>
<p>根据ACF、PACF的绘图结果，以及函数<code>auto.arima</code>得到的结果，考虑以下三种模型：</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="第五章作业.html#cb165-1" tabindex="-1"></a><span class="fu">sarima</span>(oil,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## initial  value 0.952571 
## iter   2 value 0.942301
## iter   3 value 0.937016
## iter   4 value 0.936980
## iter   5 value 0.936974
## iter   6 value 0.936920
## iter   7 value 0.936798
## iter   8 value 0.936348
## iter   9 value 0.936163
## iter  10 value 0.935594
## iter  11 value 0.934155
## iter  12 value 0.932933
## iter  13 value 0.932770
## iter  14 value 0.932398
## iter  15 value 0.930981
## iter  16 value 0.930759
## iter  17 value 0.929725
## iter  18 value 0.928816
## iter  19 value 0.928770
## iter  20 value 0.928759
## iter  21 value 0.928732
## iter  22 value 0.928703
## iter  23 value 0.928683
## iter  24 value 0.928676
## iter  25 value 0.928674
## iter  26 value 0.928673
## iter  27 value 0.928673
## iter  27 value 0.928673
## iter  27 value 0.928673
## final  value 0.928673 
## converged
## initial  value 0.927798 
## iter   2 value 0.927797
## iter   3 value 0.927797
## iter   4 value 0.927797
## iter   5 value 0.927797
## iter   6 value 0.927797
## iter   7 value 0.927797
## iter   7 value 0.927797
## iter   7 value 0.927797
## final  value 0.927797 
## converged</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
##     xreg = constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
##         REPORT = 1, reltol = tol))
## 
## Coefficients:
##          ar1      ma1      ma2  constant
##       0.8933  -0.7330  -0.0725    0.0643
## s.e.  0.0488   0.0662   0.0465    0.1964
## 
## sigma^2 estimated as 6.394:  log likelihood = -1276.62,  aic = 2563.25
## 
## $degrees_of_freedom
## [1] 540
## 
## $ttable
##          Estimate     SE  t.value p.value
## ar1        0.8933 0.0488  18.2933  0.0000
## ma1       -0.7330 0.0662 -11.0722  0.0000
## ma2       -0.0725 0.0465  -1.5597  0.1194
## constant   0.0643 0.1964   0.3276  0.7434
## 
## $AIC
## [1] 4.711854
## 
## $AICc
## [1] 4.71199
## 
## $BIC
## [1] 4.751366</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="第五章作业.html#cb168-1" tabindex="-1"></a><span class="fu">sarima</span>(oil,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## initial  value 0.951657 
## iter   2 value 0.932292
## iter   3 value 0.931893
## iter   4 value 0.931868
## iter   5 value 0.931866
## iter   6 value 0.931866
## iter   7 value 0.931866
## iter   8 value 0.931866
## iter   8 value 0.931866
## iter   8 value 0.931866
## final  value 0.931866 
## converged
## initial  value 0.931909 
## iter   2 value 0.931909
## iter   2 value 0.931909
## iter   2 value 0.931909
## final  value 0.931909 
## converged</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-83-2.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
##     xreg = constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
##         REPORT = 1, reltol = tol))
## 
## Coefficients:
##          ma1     ma2     ma3  constant
##       0.1664  0.0336  0.0919    0.0739
## s.e.  0.0431  0.0414  0.0417    0.1406
## 
## sigma^2 estimated as 6.448:  log likelihood = -1278.86,  aic = 2567.72
## 
## $degrees_of_freedom
## [1] 540
## 
## $ttable
##          Estimate     SE t.value p.value
## ma1        0.1664 0.0431  3.8631  0.0001
## ma2        0.0336 0.0414  0.8111  0.4177
## ma3        0.0919 0.0417  2.2012  0.0281
## constant   0.0739 0.1406  0.5261  0.5990
## 
## $AIC
## [1] 4.720078
## 
## $AICc
## [1] 4.720214
## 
## $BIC
## [1] 4.75959</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="第五章作业.html#cb171-1" tabindex="-1"></a><span class="fu">sarima</span>(oil,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## initial  value 0.952571 
## iter   2 value 0.942681
## iter   3 value 0.937165
## iter   4 value 0.937152
## iter   5 value 0.937039
## iter   6 value 0.936783
## iter   7 value 0.934747
## iter   8 value 0.933927
## iter   9 value 0.933726
## iter  10 value 0.933677
## iter  11 value 0.933316
## iter  12 value 0.932849
## iter  13 value 0.932728
## iter  14 value 0.931401
## iter  15 value 0.931353
## iter  16 value 0.931266
## iter  17 value 0.931094
## iter  18 value 0.930978
## iter  19 value 0.930956
## iter  20 value 0.930950
## iter  21 value 0.930944
## iter  22 value 0.930941
## iter  23 value 0.930934
## iter  24 value 0.930933
## iter  25 value 0.930932
## iter  26 value 0.930930
## iter  27 value 0.930929
## iter  28 value 0.930929
## iter  28 value 0.930929
## final  value 0.930929 
## converged
## initial  value 0.930069 
## iter   2 value 0.930068
## iter   3 value 0.930068
## iter   4 value 0.930068
## iter   5 value 0.930068
## iter   6 value 0.930068
## iter   6 value 0.930068
## iter   6 value 0.930068
## final  value 0.930068 
## converged</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-83-3.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
##     xreg = constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
##         REPORT = 1, reltol = tol))
## 
## Coefficients:
##          ar1      ma1  constant
##       0.8739  -0.7702    0.0629
## s.e.  0.0600   0.0779    0.1968
## 
## sigma^2 estimated as 6.423:  log likelihood = -1277.86,  aic = 2563.72
## 
## $degrees_of_freedom
## [1] 541
## 
## $ttable
##          Estimate     SE t.value p.value
## ar1        0.8739 0.0600 14.5683  0.0000
## ma1       -0.7702 0.0779 -9.8897  0.0000
## constant   0.0629 0.1968  0.3198  0.7493
## 
## $AIC
## [1] 4.712719
## 
## $AICc
## [1] 4.712801
## 
## $BIC
## [1] 4.744329</code></pre>
</div>
<div id="陆地温度数据" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> 5.4 陆地温度数据<a href="第五章作业.html#陆地温度数据" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>绘制时间序列的时序图，由于数据具有趋势性，考虑进行一次差分，差分后数据不再具有明显的趋势性。</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="第五章作业.html#cb174-1" tabindex="-1"></a><span class="fu">tsplot</span>(gtemp_land)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="第五章作业.html#cb175-1" tabindex="-1"></a><span class="fu">tsplot</span>(<span class="fu">diff</span>(gtemp_land))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-84-2.png" width="672" /></p>
<p>根据ACF、PACF的绘图结果，以及函数<code>auto.arima</code>得到的结果，可以选择模型为ARIMA(0,1,1)。</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="第五章作业.html#cb176-1" tabindex="-1"></a><span class="fu">acf2</span>(<span class="fu">diff</span>(gtemp_land))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
<pre><code>##       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7] [,8]  [,9] [,10] [,11] [,12]
## ACF  -0.41 -0.01 -0.17  0.18 -0.08 -0.01 -0.02 0.13 -0.16  0.17 -0.09  0.02
## PACF -0.41 -0.22 -0.33 -0.08 -0.11 -0.13 -0.10 0.05 -0.13  0.11  0.05 -0.01
##      [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
## ACF  -0.05  0.03  0.06 -0.10  0.04  0.08 -0.14  0.12 -0.08  0.15
## PACF  0.03 -0.02  0.07 -0.05  0.01  0.09 -0.10  0.07  0.00  0.13</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="第五章作业.html#cb178-1" tabindex="-1"></a><span class="fu">auto.arima</span>(gtemp_land)</span></code></pre></div>
<pre><code>## Series: gtemp_land 
## ARIMA(0,1,1) with drift 
## 
## Coefficients:
##           ma1   drift
##       -0.7023  0.0139
## s.e.   0.0601  0.0044
## 
## sigma^2 = 0.03049:  log likelihood = 46.68
## AIC=-87.35   AICc=-87.18   BIC=-78.51</code></pre>
<p>因此，可以拟合模型，并且进行检验:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="第五章作业.html#cb180-1" tabindex="-1"></a><span class="fu">sarima</span>(gtemp_land,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## initial  value -1.579037 
## iter   2 value -1.707300
## iter   3 value -1.730190
## iter   4 value -1.744969
## iter   5 value -1.749548
## iter   6 value -1.751354
## iter   7 value -1.751897
## iter   8 value -1.752066
## iter   9 value -1.752339
## iter  10 value -1.752344
## iter  11 value -1.752344
## iter  11 value -1.752344
## final  value -1.752344 
## converged
## initial  value -1.749940 
## iter   2 value -1.749961
## iter   3 value -1.749966
## iter   4 value -1.749973
## iter   4 value -1.749973
## iter   4 value -1.749973
## final  value -1.749973 
## converged</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
##     xreg = constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
##         REPORT = 1, reltol = tol))
## 
## Coefficients:
##           ma1  constant
##       -0.7023    0.0139
## s.e.   0.0601    0.0044
## 
## sigma^2 estimated as 0.03005:  log likelihood = 46.68,  aic = -87.35
## 
## $degrees_of_freedom
## [1] 139
## 
## $ttable
##          Estimate     SE  t.value p.value
## ma1       -0.7023 0.0601 -11.6793  0.0000
## constant   0.0139 0.0044   3.1382  0.0021
## 
## $AIC
## [1] -0.6195152
## 
## $AICc
## [1] -0.6188985
## 
## $BIC
## [1] -0.5567756</code></pre>
<p>从Ljung-Box统计量的检验结果来看，模型也具有较好的残差性质。</p>
</div>
<div id="海洋温度数据" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> 5.5 海洋温度数据<a href="第五章作业.html#海洋温度数据" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>绘制时间序列的时序图，由于数据具有趋势性，考虑进行一次差分，差分后数据不再具有明显的趋势性。</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="第五章作业.html#cb183-1" tabindex="-1"></a><span class="fu">tsplot</span>(gtemp_ocean)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="第五章作业.html#cb184-1" tabindex="-1"></a><span class="fu">tsplot</span>(<span class="fu">diff</span>(gtemp_ocean))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-87-2.png" width="672" /></p>
<p>根据ACF、PACF的绘图结果，以及函数<code>auto.arima</code>得到的结果，可以选择模型为ARIMA(1,1,3)。</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="第五章作业.html#cb185-1" tabindex="-1"></a><span class="fu">auto.arima</span>(gtemp_ocean)</span></code></pre></div>
<pre><code>## Series: gtemp_ocean 
## ARIMA(1,1,3) 
## 
## Coefficients:
##           ar1     ma1      ma2      ma3
##       -0.9258  0.9190  -0.5010  -0.5120
## s.e.   0.0554  0.0912   0.0906   0.0803
## 
## sigma^2 = 0.007738:  log likelihood = 144.29
## AIC=-278.59   AICc=-278.14   BIC=-263.84</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="第五章作业.html#cb187-1" tabindex="-1"></a><span class="fu">acf2</span>(<span class="fu">diff</span>(gtemp_ocean))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-88-1.png" width="672" /></p>
<pre><code>##       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7] [,8]  [,9] [,10] [,11] [,12]
## ACF  -0.04 -0.44  0.01  0.14 -0.06 -0.07  0.03 0.05 -0.11  0.05  0.04 -0.07
## PACF -0.04 -0.44 -0.03 -0.07 -0.09 -0.05 -0.04 0.01 -0.14  0.07 -0.07 -0.03
##      [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
## ACF  -0.06  0.09 -0.03 -0.05 -0.03  0.18  0.06 -0.12  0.05  0.03
## PACF -0.07  0.03 -0.10 -0.01 -0.10  0.16  0.05  0.03  0.13 -0.03</code></pre>
<p>因此，可以拟合模型，并且进行检验:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="第五章作业.html#cb189-1" tabindex="-1"></a><span class="fu">sarima</span>(gtemp_land,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## initial  value -1.578713 
## iter   2 value -1.703207
## iter   3 value -1.717012
## iter   4 value -1.735429
## iter   5 value -1.746726
## iter   6 value -1.751436
## iter   7 value -1.751677
## iter   8 value -1.752187
## iter   9 value -1.753434
## iter  10 value -1.757103
## iter  11 value -1.757729
## iter  12 value -1.758429
## iter  13 value -1.758949
## iter  14 value -1.759725
## iter  15 value -1.759875
## iter  16 value -1.759939
## iter  17 value -1.760158
## iter  18 value -1.760161
## iter  19 value -1.760163
## iter  20 value -1.760168
## iter  21 value -1.760170
## iter  22 value -1.760171
## iter  23 value -1.760171
## iter  23 value -1.760171
## final  value -1.760171 
## converged
## initial  value -1.763590 
## iter   2 value -1.763605
## iter   3 value -1.763621
## iter   4 value -1.763647
## iter   5 value -1.763686
## iter   6 value -1.763755
## iter   7 value -1.763972
## iter   8 value -1.764121
## iter   9 value -1.764311
## iter  10 value -1.764348
## iter  11 value -1.764350
## iter  12 value -1.764351
## iter  12 value -1.764351
## final  value -1.764351 
## converged</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
##     xreg = constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
##         REPORT = 1, reltol = tol))
## 
## Coefficients:
##           ar1     ma1      ma2      ma3  constant
##       -0.9176  0.3081  -0.6233  -0.1471    0.0138
## s.e.   0.1037  0.1293   0.1012   0.0827    0.0041
## 
## sigma^2 estimated as 0.02919:  log likelihood = 48.7,  aic = -85.41
## 
## $degrees_of_freedom
## [1] 136
## 
## $ttable
##          Estimate     SE t.value p.value
## ar1       -0.9176 0.1037 -8.8486  0.0000
## ma1        0.3081 0.1293  2.3823  0.0186
## ma2       -0.6233 0.1012 -6.1578  0.0000
## ma3       -0.1471 0.0827 -1.7787  0.0775
## constant   0.0138 0.0041  3.3451  0.0011
## 
## $AIC
## [1] -0.6057187
## 
## $AICc
## [1] -0.6025666
## 
## $BIC
## [1] -0.4802395</code></pre>
<p>从Ljung-Box统计量的检验结果来看，模型也具有较好的残差性质。</p>
</div>
<div id="二氧化硫序列" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> 5.6 二氧化硫序列<a href="第五章作业.html#二氧化硫序列" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>绘制时间序列的时序图，由于数据具有趋势性，考虑进行一次差分，差分后数据不再具有明显的趋势性。</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="第五章作业.html#cb192-1" tabindex="-1"></a><span class="fu">tsplot</span>(so2)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-90-1.png" width="672" /></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="第五章作业.html#cb193-1" tabindex="-1"></a><span class="fu">tsplot</span>(<span class="fu">diff</span>(so2))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-90-2.png" width="672" /></p>
<p>其次，确定模型的阶数，按照题目要求，无需拟合含季节项的ARIMA模型：</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="第五章作业.html#cb194-1" tabindex="-1"></a><span class="fu">auto.arima</span>(so2,<span class="at">seasonal =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Series: so2 
## ARIMA(1,1,2) 
## 
## Coefficients:
##           ar1      ma1      ma2
##       -0.8146  -0.0705  -0.6178
## s.e.   0.1122   0.1250   0.1108
## 
## sigma^2 = 0.7809:  log likelihood = -655.81
## AIC=1319.63   AICc=1319.71   BIC=1336.54</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="第五章作业.html#cb196-1" tabindex="-1"></a><span class="fu">acf2</span>(<span class="fu">diff</span>(so2))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-91-1.png" width="672" /></p>
<pre><code>##       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]
## ACF  -0.54  0.13 -0.15  0.09 -0.02  0.00 -0.03  0.05 -0.05  0.09 -0.11  0.03
## PACF -0.54 -0.24 -0.28 -0.19 -0.12 -0.11 -0.12 -0.04 -0.07  0.05 -0.01 -0.06
##      [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
## ACF   0.05 -0.07  0.06 -0.08  0.08 -0.05  0.07 -0.06  0.04 -0.11  0.14 -0.11
## PACF  0.05 -0.04 -0.01 -0.09 -0.06 -0.08  0.00 -0.03  0.01 -0.13 -0.03 -0.06
##      [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36]
## ACF   0.10 -0.07  0.06 -0.05 -0.01  0.04 -0.03 -0.01  0.02 -0.01  0.03  0.00
## PACF -0.02 -0.01  0.02  0.01 -0.05  0.02  0.00 -0.03 -0.02 -0.02  0.01  0.03
##      [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]
## ACF  -0.06  0.08 -0.08  0.11 -0.17  0.14 -0.05 -0.01  0.03 -0.06  0.03  0.02
## PACF -0.07 -0.02 -0.06  0.02 -0.11 -0.06 -0.02 -0.10 -0.01 -0.09 -0.07 -0.04
##      [,49] [,50] [,51] [,52] [,53] [,54] [,55] [,56] [,57] [,58] [,59] [,60]
## ACF  -0.03  0.01  0.04 -0.04  0.02 -0.07  0.13 -0.08 -0.02  0.10 -0.09  0.03
## PACF -0.04 -0.08  0.04  0.00  0.00 -0.06  0.04  0.06 -0.09  0.09  0.00 -0.02
##      [,61] [,62] [,63] [,64] [,65] [,66] [,67] [,68] [,69] [,70] [,71] [,72]
## ACF  -0.01 -0.01  0.04 -0.08  0.04  0.02 -0.02  0.03 -0.01 -0.03  0.07 -0.09
## PACF -0.02 -0.02 -0.01 -0.05 -0.10 -0.03 -0.02 -0.05  0.04 -0.06  0.08 -0.01
##      [,73] [,74] [,75] [,76] [,77] [,78] [,79] [,80] [,81] [,82] [,83] [,84]
## ACF   0.05 -0.05  0.06 -0.01 -0.02  0.05 -0.11  0.08  0.01 -0.06  0.08 -0.08
## PACF  0.00 -0.05 -0.02  0.01  0.01  0.05 -0.07 -0.02  0.01 -0.07  0.03 -0.02
##      [,85] [,86] [,87] [,88] [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96]
## ACF   0.08 -0.07  0.05 -0.02 -0.02  0.05 -0.03 -0.01  0.03 -0.02  0.03 -0.03
## PACF -0.02 -0.04  0.00 -0.02 -0.05 -0.01 -0.01 -0.01 -0.01 -0.01  0.02  0.01
##      [,97] [,98] [,99] [,100] [,101] [,102] [,103] [,104] [,105] [,106] [,107]
## ACF  -0.03  0.04  0.02  -0.02   0.01  -0.03   0.04  -0.04   0.04  -0.02   0.00
## PACF -0.04 -0.07  0.06  -0.06  -0.01  -0.03  -0.02  -0.03   0.01   0.00   0.03
##      [,108] [,109] [,110] [,111] [,112] [,113] [,114] [,115] [,116] [,117]
## ACF   -0.02   0.04  -0.05   0.05  -0.09   0.13  -0.09   0.05  -0.02  -0.03
## PACF  -0.03   0.04  -0.01  -0.02  -0.02   0.00   0.00   0.04   0.03  -0.03
##      [,118] [,119] [,120] [,121] [,122] [,123] [,124] [,125] [,126] [,127]
## ACF    0.10  -0.09   0.01   0.01  -0.03   0.06  -0.09   0.10  -0.06   0.00
## PACF   0.08   0.05  -0.02   0.04  -0.03   0.02  -0.07   0.04  -0.03  -0.02
##      [,128] [,129] [,130] [,131] [,132] [,133] [,134] [,135] [,136] [,137]
## ACF    0.02   0.04  -0.08   0.04   0.01   0.00  -0.04   0.04  -0.01   0.00
## PACF  -0.01   0.12   0.00   0.02   0.05   0.01  -0.04  -0.01  -0.04  -0.02
##      [,138] [,139] [,140] [,141] [,142] [,143] [,144] [,145] [,146] [,147]
## ACF    0.06  -0.06  -0.06   0.10  -0.04   0.01  -0.02   0.00   0.04  -0.06
## PACF   0.03   0.03  -0.08  -0.02   0.01  -0.03  -0.01  -0.01   0.01   0.00
##      [,148] [,149] [,150] [,151] [,152] [,153] [,154] [,155] [,156] [,157]
## ACF    0.03  -0.01   0.00   0.02   0.00   0.00   0.02  -0.06   0.05  -0.06
## PACF  -0.05  -0.03  -0.02  -0.03   0.01   0.04   0.05   0.00  -0.08  -0.07
##      [,158] [,159] [,160] [,161] [,162] [,163] [,164] [,165] [,166] [,167]
## ACF    0.14  -0.10   0.01  -0.01   0.00   0.00   0.02  -0.01  -0.06   0.06
## PACF   0.06   0.09   0.00  -0.01  -0.01  -0.02   0.05   0.06  -0.04  -0.02
##      [,168] [,169] [,170] [,171] [,172] [,173] [,174] [,175] [,176] [,177]
## ACF    0.01  -0.03   0.01   0.04  -0.08   0.06  -0.08   0.08  -0.02   0.03
## PACF   0.01  -0.01   0.01   0.03  -0.02   0.02  -0.05   0.04  -0.05   0.00
##      [,178] [,179] [,180] [,181] [,182] [,183] [,184] [,185] [,186] [,187]
## ACF   -0.04  -0.02   0.02   0.04  -0.03   0.01  -0.01  -0.06   0.08  -0.03
## PACF   0.02  -0.03  -0.07  -0.02   0.06   0.02   0.01  -0.04   0.00   0.04
##      [,188] [,189] [,190] [,191] [,192] [,193] [,194] [,195] [,196] [,197]
## ACF   -0.03   0.03   0.00  -0.01  -0.03   0.04   0.05  -0.10   0.09  -0.11
## PACF  -0.05   0.00   0.02   0.02  -0.07  -0.02   0.01   0.02  -0.01  -0.06
##      [,198] [,199] [,200] [,201] [,202] [,203] [,204] [,205] [,206] [,207]
## ACF    0.10  -0.07   0.10  -0.08   0.03  -0.02   0.04  -0.08   0.07  -0.04
## PACF  -0.03  -0.07   0.04   0.00   0.04   0.00   0.05  -0.03   0.00  -0.02
##      [,208]
## ACF    0.04
## PACF  -0.01</code></pre>
<p>根据ACF、PACF的绘图结果，以及函数<code>auto.arima</code>得到的结果，可以选择模型为ARIMA(1,1,2)。因此可以拟合模型并进行检验：</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="第五章作业.html#cb198-1" tabindex="-1"></a><span class="fu">sarima</span>(so2,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## initial  value 0.161610 
## iter   2 value 0.012216
## iter   3 value -0.095221
## iter   4 value -0.116285
## iter   5 value -0.121413
## iter   6 value -0.121645
## iter   7 value -0.122190
## iter   8 value -0.122471
## iter   9 value -0.122499
## iter  10 value -0.122644
## iter  11 value -0.122663
## iter  12 value -0.122691
## iter  13 value -0.122740
## iter  14 value -0.122787
## iter  15 value -0.123095
## iter  16 value -0.124040
## iter  17 value -0.124892
## iter  18 value -0.125445
## iter  19 value -0.125640
## iter  20 value -0.125751
## iter  21 value -0.125773
## iter  22 value -0.125849
## iter  23 value -0.125924
## iter  24 value -0.126063
## iter  25 value -0.126090
## iter  26 value -0.126094
## iter  27 value -0.126094
## iter  27 value -0.126094
## iter  27 value -0.126094
## final  value -0.126094 
## converged
## initial  value -0.125534 
## iter   2 value -0.125536
## iter   3 value -0.125538
## iter   4 value -0.125538
## iter   5 value -0.125538
## iter   6 value -0.125540
## iter   7 value -0.125542
## iter   8 value -0.125545
## iter   9 value -0.125546
## iter  10 value -0.125546
## iter  10 value -0.125546
## final  value -0.125546 
## converged</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
##     xreg = constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
##         REPORT = 1, reltol = tol))
## 
## Coefficients:
##           ar1      ma1      ma2  constant
##       -0.8147  -0.0708  -0.6185   -0.0024
## s.e.   0.1121   0.1249   0.1108    0.0068
## 
## sigma^2 estimated as 0.7761:  log likelihood = -655.75,  aic = 1321.5
## 
## $degrees_of_freedom
## [1] 503
## 
## $ttable
##          Estimate     SE t.value p.value
## ar1       -0.8147 0.1121 -7.2681  0.0000
## ma1       -0.0708 0.1249 -0.5666  0.5712
## ma2       -0.6185 0.1108 -5.5794  0.0000
## constant  -0.0024 0.0068 -0.3562  0.7218
## 
## $AIC
## [1] 2.606509
## 
## $AICc
## [1] 2.606666
## 
## $BIC
## [1] 2.64821</code></pre>
<p>因此，可以在中建立模型并且预测得到4个95%的预测区间：</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="第五章作业.html#cb201-1" tabindex="-1"></a>so2_model <span class="ot">&lt;-</span> <span class="fu">arima</span>(so2, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb201-2"><a href="第五章作业.html#cb201-2" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(so2_model,<span class="at">n.ahead =</span> <span class="dv">4</span>,<span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb201-3"><a href="第五章作业.html#cb201-3" tabindex="-1"></a></span>
<span id="cb201-4"><a href="第五章作业.html#cb201-4" tabindex="-1"></a>lower_bound <span class="ot">&lt;-</span> prediction<span class="sc">$</span>pred <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> prediction<span class="sc">$</span>se</span>
<span id="cb201-5"><a href="第五章作业.html#cb201-5" tabindex="-1"></a>upper_bound <span class="ot">&lt;-</span> prediction<span class="sc">$</span>pred <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> prediction<span class="sc">$</span>se</span>
<span id="cb201-6"><a href="第五章作业.html#cb201-6" tabindex="-1"></a></span>
<span id="cb201-7"><a href="第五章作业.html#cb201-7" tabindex="-1"></a>prediction_interval <span class="ot">&lt;-</span> <span class="fu">cbind</span>(lower_bound,prediction<span class="sc">$</span>pred,upper_bound)</span>
<span id="cb201-8"><a href="第五章作业.html#cb201-8" tabindex="-1"></a>prediction_interval</span></code></pre></div>
<pre><code>## Time Series:
## Start = c(1979, 41) 
## End = c(1979, 44) 
## Frequency = 52 
##          lower_bound prediction$pred upper_bound
## 1979.769  0.10072141        1.827613    3.554505
## 1979.788  0.07333962        1.811609    3.549878
## 1979.808  0.04605221        1.824646    3.603239
## 1979.827  0.02042162        1.814026    3.607631</code></pre>
</div>
<div id="国际航班乘客数据" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> 5.7 国际航班乘客数据<a href="第五章作业.html#国际航班乘客数据" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>绘制时间序列的时序图，由于数据具有趋势性，考虑进行一次差分，差分后数据不再具有明显的趋势性。</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="第五章作业.html#cb203-1" tabindex="-1"></a><span class="fu">tsplot</span>(AirPassengers)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="第五章作业.html#cb204-1" tabindex="-1"></a><span class="fu">tsplot</span>(<span class="fu">diff</span>(AirPassengers))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-94-2.png" width="672" /></p>
<p>其次确定模型阶数：</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="第五章作业.html#cb205-1" tabindex="-1"></a><span class="fu">auto.arima</span>(AirPassengers)</span></code></pre></div>
<pre><code>## Series: AirPassengers 
## ARIMA(2,1,1)(0,1,0)[12] 
## 
## Coefficients:
##          ar1     ar2      ma1
##       0.5960  0.2143  -0.9819
## s.e.  0.0888  0.0880   0.0292
## 
## sigma^2 = 132.3:  log likelihood = -504.92
## AIC=1017.85   AICc=1018.17   BIC=1029.35</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="第五章作业.html#cb207-1" tabindex="-1"></a><span class="fu">acf2</span>(<span class="fu">diff</span>(AirPassengers))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]
## ACF   0.3 -0.10 -0.24 -0.30 -0.09 -0.08 -0.09 -0.29 -0.19 -0.10  0.28  0.83
## PACF  0.3 -0.21 -0.16 -0.22  0.01 -0.19 -0.15 -0.45 -0.23 -0.55 -0.13  0.57
##      [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
## ACF   0.28 -0.11 -0.22 -0.23 -0.06 -0.07 -0.09 -0.30 -0.16 -0.08  0.26  0.70
## PACF -0.15 -0.17  0.07  0.06  0.01 -0.08  0.04 -0.09  0.00 -0.01 -0.04 -0.04
##      [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36]
## ACF   0.26 -0.10 -0.20 -0.17 -0.07 -0.04 -0.08 -0.25 -0.16 -0.05  0.20  0.58
## PACF -0.03 -0.04  0.02 -0.06 -0.13  0.01  0.03  0.07 -0.13  0.09 -0.12 -0.01
##      [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]
## ACF   0.23 -0.11 -0.13 -0.12 -0.05 -0.03 -0.08 -0.23 -0.14 -0.03  0.15  0.49
## PACF  0.00 -0.08  0.09 -0.01  0.03  0.02 -0.02  0.00  0.05  0.00  0.00  0.02</code></pre>
<p>根据ACF、PACF的绘图结果，以及函数<code>auto.arima</code>得到的结果，可以选择模型为SARIMA(2,1,1,0,1,0)[12]。因此可以拟合模型并进行检验：</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="第五章作业.html#cb209-1" tabindex="-1"></a><span class="fu">sarima</span>(AirPassengers,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">12</span>)</span></code></pre></div>
<pre><code>## initial  value 2.517519 
## iter   2 value 2.509697
## iter   3 value 2.467921
## iter   4 value 2.466885
## iter   5 value 2.466822
## iter   6 value 2.466820
## iter   7 value 2.466818
## iter   8 value 2.466573
## iter   9 value 2.466534
## iter  10 value 2.466448
## iter  11 value 2.466431
## iter  12 value 2.465905
## iter  13 value 2.462991
## iter  14 value 2.455334
## iter  15 value 2.447759
## iter  16 value 2.446231
## iter  17 value 2.434390
## iter  18 value 2.433031
## iter  19 value 2.431071
## iter  20 value 2.429169
## iter  21 value 2.428820
## iter  22 value 2.424214
## iter  23 value 2.422934
## iter  24 value 2.420119
## iter  25 value 2.415841
## iter  26 value 2.413134
## iter  27 value 2.411637
## iter  28 value 2.409041
## iter  28 value 2.409041
## iter  29 value 2.407667
## iter  30 value 2.406729
## iter  30 value 2.406729
## iter  31 value 2.405219
## iter  32 value 2.403385
## iter  32 value 2.403385
## iter  33 value 2.401642
## iter  33 value 2.401642
## iter  34 value 2.401351
## iter  35 value 2.401318
## iter  35 value 2.401318
## iter  36 value 2.401218
## iter  37 value 2.400815
## iter  37 value 2.400815
## iter  38 value 2.400753
## iter  38 value 2.400753
## iter  39 value 2.400730
## iter  40 value 2.400725
## iter  41 value 2.399877
## iter  41 value 2.399877
## iter  42 value 2.399851
## iter  42 value 2.399851
## iter  43 value 2.399842
## iter  43 value 2.399842
## iter  44 value 2.399839
## iter  44 value 2.399839
## iter  45 value 2.399838
## iter  45 value 2.399838
## iter  46 value 2.399838
## iter  46 value 2.399838
## iter  47 value 2.399838
## iter  47 value 2.399838
## iter  47 value 2.399838
## final  value 2.399838 
## converged
## initial  value 2.454840 
## iter   2 value 2.440932
## iter   3 value 2.438265
## iter   4 value 2.437665
## iter   5 value 2.436460
## iter   6 value 2.435972
## iter   7 value 2.435600
## iter   8 value 2.435494
## iter   9 value 2.435473
## iter  10 value 2.435458
## iter  11 value 2.435451
## iter  12 value 2.435443
## iter  13 value 2.435442
## iter  14 value 2.435442
## iter  14 value 2.435442
## iter  14 value 2.435442
## final  value 2.435442 
## converged</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
##     include.mean = !no.constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
##         REPORT = 1, reltol = tol))
## 
## Coefficients:
##          ar1     ar2      ma1
##       0.5960  0.2143  -0.9819
## s.e.  0.0888  0.0880   0.0292
## 
## sigma^2 estimated as 129.3:  log likelihood = -504.92,  aic = 1017.85
## 
## $degrees_of_freedom
## [1] 128
## 
## $ttable
##     Estimate     SE  t.value p.value
## ar1   0.5960 0.0888   6.7101  0.0000
## ar2   0.2143 0.0880   2.4359  0.0162
## ma1  -0.9819 0.0292 -33.6239  0.0000
## 
## $AIC
## [1] 7.76983
## 
## $AICc
## [1] 7.771272
## 
## $BIC
## [1] 7.857622</code></pre>
</div>
<div id="季节性arima模型acf的绘制" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> 5.8 季节性ARIMA模型ACF的绘制<a href="第五章作业.html#季节性arima模型acf的绘制" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="第五章作业.html#cb212-1" tabindex="-1"></a>ACF <span class="ot">=</span> <span class="fu">ARMAacf</span>(<span class="at">ar=</span> .<span class="dv">8</span>, <span class="at">ma=</span> .<span class="dv">5</span> , <span class="dv">50</span>)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb212-2"><a href="第五章作业.html#cb212-2" tabindex="-1"></a>LAG<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">50</span><span class="sc">/</span><span class="dv">12</span></span>
<span id="cb212-3"><a href="第五章作业.html#cb212-3" tabindex="-1"></a><span class="fu">plot</span>(LAG,ACF,<span class="at">type=</span><span class="st">&quot;h&quot;</span>,<span class="at">panel.first=</span><span class="fu">Grid</span>(),<span class="at">xlab =</span> <span class="st">&quot;LAG/12&quot;</span>)</span>
<span id="cb212-4"><a href="第五章作业.html#cb212-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
</div>
<div id="鸡肉价格数据" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> 5.9 鸡肉价格数据<a href="第五章作业.html#鸡肉价格数据" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>绘制时间序列的时序图，由于数据具有趋势性，考虑进行一次差分，差分后数据不再具有明显的趋势性。</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="第五章作业.html#cb213-1" tabindex="-1"></a><span class="fu">tsplot</span>(chicken)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="第五章作业.html#cb214-1" tabindex="-1"></a><span class="fu">tsplot</span>(<span class="fu">diff</span>(chicken))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-98-2.png" width="672" /></p>
<p>其次确定模型阶数：</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="第五章作业.html#cb215-1" tabindex="-1"></a><span class="fu">auto.arima</span>(chicken)</span></code></pre></div>
<pre><code>## Series: chicken 
## ARIMA(2,1,1)(0,0,1)[12] with drift 
## 
## Coefficients:
##          ar1      ar2      ma1    sma1   drift
##       1.2933  -0.5375  -0.4019  0.2756  0.2518
## s.e.  0.2220   0.1542   0.2569  0.0692  0.1428
## 
## sigma^2 = 0.396:  log likelihood = -169.51
## AIC=351.01   AICc=351.5   BIC=370.14</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="第五章作业.html#cb217-1" tabindex="-1"></a><span class="fu">acf2</span>(<span class="fu">diff</span>(chicken))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<pre><code>##      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]
## ACF  0.72  0.39  0.09 -0.07 -0.16 -0.20 -0.27 -0.23 -0.11  0.09  0.26  0.33
## PACF 0.72 -0.29 -0.14  0.03 -0.10 -0.06 -0.19  0.12  0.10  0.16  0.09  0.00
##      [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
## ACF   0.20  0.07 -0.03 -0.10 -0.19 -0.25 -0.29 -0.20 -0.08  0.08  0.16  0.18
## PACF -0.22  0.03  0.03 -0.11 -0.09  0.01 -0.03  0.07 -0.04  0.06 -0.05  0.02
##      [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36]
## ACF   0.08 -0.06 -0.21 -0.31 -0.40 -0.40 -0.33 -0.18  0.02  0.20  0.30  0.35
## PACF -0.14 -0.19 -0.13 -0.06 -0.08 -0.05  0.01  0.03  0.10  0.02 -0.01  0.09
##      [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]
## ACF   0.26  0.13 -0.02 -0.14 -0.23 -0.21 -0.18 -0.11 -0.03  0.08  0.21  0.33
## PACF -0.12  0.01 -0.01 -0.05  0.02  0.12 -0.05 -0.13 -0.07  0.01  0.14  0.05</code></pre>
<p>根据ACF、PACF的绘图结果，以及函数<code>auto.arima</code>得到的结果，可以选择模型为SARIMA(2,1,1,0,0,1)[12]。因此可以拟合模型并进行检验：</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="第五章作业.html#cb219-1" tabindex="-1"></a><span class="fu">sarima</span>(chicken,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">12</span>)</span></code></pre></div>
<pre><code>## initial  value 0.001863 
## iter   2 value -0.186345
## iter   3 value -0.335095
## iter   4 value -0.383350
## iter   5 value -0.449917
## iter   6 value -0.457049
## iter   7 value -0.458930
## iter   8 value -0.477713
## iter   9 value -0.479940
## iter  10 value -0.483436
## iter  11 value -0.484450
## iter  12 value -0.484732
## iter  13 value -0.484787
## iter  14 value -0.484878
## iter  15 value -0.484968
## iter  16 value -0.485043
## iter  17 value -0.485054
## iter  18 value -0.485055
## iter  19 value -0.485055
## iter  20 value -0.485056
## iter  21 value -0.485056
## iter  22 value -0.485056
## iter  22 value -0.485056
## iter  22 value -0.485056
## final  value -0.485056 
## converged
## initial  value -0.471707 
## iter   2 value -0.471845
## iter   3 value -0.471862
## iter   4 value -0.471876
## iter   5 value -0.471916
## iter   6 value -0.471951
## iter   7 value -0.471961
## iter   8 value -0.471966
## iter   9 value -0.471970
## iter  10 value -0.471973
## iter  11 value -0.471974
## iter  12 value -0.471974
## iter  12 value -0.471974
## final  value -0.471974 
## converged</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
##     xreg = constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
##         REPORT = 1, reltol = tol))
## 
## Coefficients:
##          ar1      ar2      ma1    sma1  constant
##       1.2933  -0.5375  -0.4019  0.2756    0.2518
## s.e.  0.2220   0.1542   0.2569  0.0692    0.1428
## 
## sigma^2 estimated as 0.3849:  log likelihood = -169.51,  aic = 351.01
## 
## $degrees_of_freedom
## [1] 174
## 
## $ttable
##          Estimate     SE t.value p.value
## ar1        1.2933 0.2220  5.8245  0.0000
## ar2       -0.5375 0.1542 -3.4849  0.0006
## ma1       -0.4019 0.2569 -1.5647  0.1195
## sma1       0.2756 0.0692  3.9809  0.0001
## constant   0.2518 0.1428  1.7641  0.0795
## 
## $AIC
## [1] 1.960969
## 
## $AICc
## [1] 1.962906
## 
## $BIC
## [1] 2.067808</code></pre>
<p>利用拟合的季节性ARIMA模型预测未来12个月的鸡肉价格数据，并绘制在图中：</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="第五章作业.html#cb222-1" tabindex="-1"></a><span class="co"># 拟合ARIMA模型</span></span>
<span id="cb222-2"><a href="第五章作业.html#cb222-2" tabindex="-1"></a>chicken_model <span class="ot">&lt;-</span> <span class="fu">arima</span>(chicken, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb222-3"><a href="第五章作业.html#cb222-3" tabindex="-1"></a>                       <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">period =</span> <span class="dv">12</span>))</span>
<span id="cb222-4"><a href="第五章作业.html#cb222-4" tabindex="-1"></a></span>
<span id="cb222-5"><a href="第五章作业.html#cb222-5" tabindex="-1"></a><span class="co"># 对未来12个月进行预测</span></span>
<span id="cb222-6"><a href="第五章作业.html#cb222-6" tabindex="-1"></a>chicken_forecast <span class="ot">&lt;-</span> <span class="fu">predict</span>(chicken_model, <span class="at">n.ahead =</span> <span class="dv">12</span>)</span>
<span id="cb222-7"><a href="第五章作业.html#cb222-7" tabindex="-1"></a></span>
<span id="cb222-8"><a href="第五章作业.html#cb222-8" tabindex="-1"></a><span class="co"># 打印预测结果</span></span>
<span id="cb222-9"><a href="第五章作业.html#cb222-9" tabindex="-1"></a><span class="fu">print</span>(chicken_forecast<span class="sc">$</span>pred)</span></code></pre></div>
<pre><code>##           Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
## 2016                                                                111.1064
## 2017 109.8361 109.7608 109.5932 109.5923 109.6591 109.6571 109.5903         
##           Sep      Oct      Nov      Dec
## 2016 110.7519 110.3998 110.0911 110.0052
## 2017</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="第五章作业.html#cb224-1" tabindex="-1"></a><span class="co"># 绘制原始数据和预测结果的图形</span></span>
<span id="cb224-2"><a href="第五章作业.html#cb224-2" tabindex="-1"></a><span class="fu">plot</span>(chicken, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;时间&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;销售量&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Chicken Sales&quot;</span>)</span>
<span id="cb224-3"><a href="第五章作业.html#cb224-3" tabindex="-1"></a><span class="fu">lines</span>(chicken_forecast<span class="sc">$</span>pred, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb224-4"><a href="第五章作业.html#cb224-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;原始数据&quot;</span>, <span class="st">&quot;预测结果&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-101-1.png" width="672" /></p>
</div>
<div id="失业数据" class="section level2 hasAnchor" number="5.10">
<h2><span class="header-section-number">5.10</span> 5.10 失业数据<a href="第五章作业.html#失业数据" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>绘制时间序列的时序图，由于数据具有趋势性，考虑进行一次差分，差分后数据不再具有明显的趋势性。</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="第五章作业.html#cb225-1" tabindex="-1"></a><span class="fu">tsplot</span>(UnempRate)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="第五章作业.html#cb226-1" tabindex="-1"></a><span class="fu">tsplot</span>(<span class="fu">diff</span>(UnempRate))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-102-2.png" width="672" /></p>
<p>其次确定模型阶数：</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="第五章作业.html#cb227-1" tabindex="-1"></a><span class="fu">auto.arima</span>(UnempRate)</span></code></pre></div>
<pre><code>## Series: UnempRate 
## ARIMA(4,0,2)(2,1,2)[12] 
## 
## Coefficients:
##          ar1     ar2      ar3      ar4     ma1      ma2     sar1    sar2
##       0.7625  0.9558  -0.6176  -0.1234  0.3117  -0.5419  -0.7769  0.0496
## s.e.  0.0504  0.1053   0.1076   0.0411  0.0504   0.1010   0.1181  0.0548
##         sma1     sma2
##       0.0326  -0.6181
## s.e.  0.1164   0.0786
## 
## sigma^2 = 0.05468:  log likelihood = 26.25
## AIC=-30.49   AICc=-30.16   BIC=21.24</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="第五章作业.html#cb229-1" tabindex="-1"></a><span class="fu">acf2</span>(<span class="fu">diff</span>(UnempRate))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
<pre><code>##      [,1]  [,2]  [,3]  [,4] [,5]  [,6] [,7]  [,8]  [,9] [,10] [,11] [,12] [,13]
## ACF  0.08 -0.12 -0.28 -0.09 0.24 -0.03 0.21 -0.11 -0.31 -0.17  0.06  0.76  0.03
## PACF 0.08 -0.13 -0.27 -0.07 0.20 -0.16 0.26 -0.08 -0.34 -0.08  0.09  0.66 -0.16
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25]
## ACF  -0.19 -0.34 -0.13  0.19 -0.07  0.21 -0.13 -0.31 -0.17  0.04  0.75  0.02
## PACF -0.22 -0.14 -0.10 -0.06 -0.11  0.09  0.01 -0.08  0.03 -0.06  0.31 -0.05
##      [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]
## ACF  -0.18 -0.32 -0.11  0.20 -0.05  0.20 -0.14 -0.30 -0.16  0.03  0.73  0.01
## PACF -0.05 -0.02 -0.01 -0.05 -0.05 -0.04 -0.08 -0.02  0.05 -0.08  0.18 -0.05
##      [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]
## ACF  -0.16 -0.31 -0.11  0.18 -0.06  0.19 -0.14 -0.31 -0.17  0.05  0.73
## PACF  0.03 -0.04 -0.05 -0.10 -0.03 -0.03 -0.03 -0.05 -0.02  0.04  0.17</code></pre>
<p>根据ACF、PACF的绘图结果，以及函数<code>auto.arima</code>得到的结果，可以选择模型为SARIMA(4,0,2,2,1,2)[12]，因此可以拟合模型并进行检验：</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="第五章作业.html#cb231-1" tabindex="-1"></a><span class="fu">sarima</span>(UnempRate,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">12</span>)</span></code></pre></div>
<pre><code>## initial  value 0.137272 
## iter   2 value -0.866854
## iter   3 value -1.027240
## iter   4 value -1.261380
## iter   5 value -1.410876
## iter   6 value -1.457826
## iter   7 value -1.465913
## iter   8 value -1.466548
## iter   9 value -1.467989
## iter  10 value -1.468714
## iter  11 value -1.469424
## iter  12 value -1.470813
## iter  13 value -1.472047
## iter  14 value -1.474887
## iter  15 value -1.477945
## iter  16 value -1.480522
## iter  17 value -1.481351
## iter  18 value -1.483158
## iter  19 value -1.484128
## iter  20 value -1.484275
## iter  21 value -1.488574
## iter  22 value -1.489211
## iter  23 value -1.489745
## iter  24 value -1.490133
## iter  25 value -1.490195
## iter  26 value -1.490346
## iter  27 value -1.490474
## iter  28 value -1.490970
## iter  29 value -1.491588
## iter  30 value -1.492472
## iter  31 value -1.492793
## iter  32 value -1.492896
## iter  33 value -1.492944
## iter  34 value -1.493018
## iter  35 value -1.493241
## iter  36 value -1.493282
## iter  37 value -1.493298
## iter  38 value -1.493305
## iter  39 value -1.493318
## iter  40 value -1.493335
## iter  41 value -1.493341
## iter  42 value -1.493342
## iter  43 value -1.493342
## iter  44 value -1.493342
## iter  45 value -1.493342
## iter  46 value -1.493342
## iter  47 value -1.493342
## iter  47 value -1.493342
## final  value -1.493342 
## converged
## initial  value -1.449112 
## iter   2 value -1.449491
## iter   3 value -1.449500
## iter   4 value -1.450312
## iter   5 value -1.450432
## iter   6 value -1.450489
## iter   7 value -1.450496
## iter   8 value -1.450498
## iter   9 value -1.450500
## iter  10 value -1.450501
## iter  11 value -1.450501
## iter  12 value -1.450503
## iter  13 value -1.450507
## iter  14 value -1.450507
## iter  15 value -1.450507
## iter  16 value -1.450508
## iter  17 value -1.450509
## iter  18 value -1.450509
## iter  19 value -1.450511
## iter  20 value -1.450513
## iter  21 value -1.450518
## iter  22 value -1.450520
## iter  23 value -1.450533
## iter  24 value -1.450540
## iter  25 value -1.450574
## iter  26 value -1.450596
## iter  27 value -1.450628
## iter  28 value -1.450650
## iter  29 value -1.450670
## iter  30 value -1.450676
## iter  31 value -1.450731
## iter  32 value -1.450762
## iter  33 value -1.450771
## iter  34 value -1.450833
## iter  35 value -1.450868
## iter  36 value -1.450930
## iter  37 value -1.450946
## iter  38 value -1.450960
## iter  39 value -1.450979
## iter  40 value -1.450992
## iter  41 value -1.451001
## iter  42 value -1.451019
## iter  43 value -1.451055
## iter  44 value -1.451070
## iter  45 value -1.451081
## iter  46 value -1.451087
## iter  47 value -1.451090
## iter  48 value -1.451093
## iter  49 value -1.451094
## iter  50 value -1.451097
## iter  51 value -1.451111
## iter  52 value -1.451131
## iter  53 value -1.451186
## iter  54 value -1.451202
## iter  55 value -1.451218
## iter  56 value -1.451227
## iter  57 value -1.451238
## iter  58 value -1.451243
## iter  59 value -1.451244
## iter  60 value -1.451245
## iter  61 value -1.451247
## iter  62 value -1.451251
## iter  63 value -1.451256
## iter  64 value -1.451258
## iter  65 value -1.451258
## iter  66 value -1.451258
## iter  67 value -1.451258
## iter  68 value -1.451259
## iter  69 value -1.451259
## iter  70 value -1.451259
## iter  71 value -1.451259
## iter  71 value -1.451259
## iter  72 value -1.451259
## iter  72 value -1.451259
## iter  73 value -1.451259
## iter  74 value -1.451259
## iter  74 value -1.451259
## iter  74 value -1.451259
## final  value -1.451259 
## converged</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-104-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
##     xreg = constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
##         REPORT = 1, reltol = tol))
## 
## Coefficients:
##          ar1     ar2      ar3      ar4     ma1      ma2     sar1    sar2
##       0.7688  0.9491  -0.6182  -0.1223  0.3050  -0.5430  -0.7766  0.0504
## s.e.  0.1686  0.0630   0.2838   0.1128  0.1463   0.2546   0.2845  0.1627
##         sma1     sma2  constant
##       0.0320  -0.6194    0.0025
## s.e.  0.2194   0.0586    0.0057
## 
## sigma^2 estimated as 0.05399:  log likelihood = 26.34,  aic = -28.68
## 
## $degrees_of_freedom
## [1] 804
## 
## $ttable
##          Estimate     SE  t.value p.value
## ar1        0.7688 0.1686   4.5593  0.0000
## ar2        0.9491 0.0630  15.0752  0.0000
## ar3       -0.6182 0.2838  -2.1780  0.0297
## ar4       -0.1223 0.1128  -1.0844  0.2785
## ma1        0.3050 0.1463   2.0850  0.0374
## ma2       -0.5430 0.2546  -2.1325  0.0333
## sar1      -0.7766 0.2845  -2.7292  0.0065
## sar2       0.0504 0.1627   0.3100  0.7567
## sma1       0.0320 0.2194   0.1460  0.8840
## sma2      -0.6194 0.0586 -10.5772  0.0000
## constant   0.0025 0.0057   0.4434  0.6576
## 
## $AIC
## [1] -0.03519297
## 
## $AICc
## [1] -0.03478958
## 
## $BIC
## [1] 0.03405642</code></pre>
<p>利用拟合的季节性ARIMA模型预测未来12个月的失业数据，并绘制在图中：</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="第五章作业.html#cb234-1" tabindex="-1"></a><span class="co"># 拟合ARIMA模型</span></span>
<span id="cb234-2"><a href="第五章作业.html#cb234-2" tabindex="-1"></a>UnempRate_model <span class="ot">&lt;-</span> <span class="fu">arima</span>(UnempRate, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb234-3"><a href="第五章作业.html#cb234-3" tabindex="-1"></a>                       <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">period =</span> <span class="dv">12</span>))</span></code></pre></div>
<pre><code>## Warning in log(s2): NaNs produced

## Warning in log(s2): NaNs produced</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="第五章作业.html#cb236-1" tabindex="-1"></a><span class="co"># 对未来12个月进行预测</span></span>
<span id="cb236-2"><a href="第五章作业.html#cb236-2" tabindex="-1"></a>UnempRate_forecast <span class="ot">&lt;-</span> <span class="fu">predict</span>(UnempRate_model, <span class="at">n.ahead =</span> <span class="dv">12</span>)</span>
<span id="cb236-3"><a href="第五章作业.html#cb236-3" tabindex="-1"></a></span>
<span id="cb236-4"><a href="第五章作业.html#cb236-4" tabindex="-1"></a><span class="co"># 打印预测结果</span></span>
<span id="cb236-5"><a href="第五章作业.html#cb236-5" tabindex="-1"></a><span class="fu">print</span>(UnempRate_forecast<span class="sc">$</span>pred)</span></code></pre></div>
<pre><code>##           Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
## 2016                                                                        
## 2017 5.188054 5.064098 4.909005 4.449382 4.585190 5.086002 5.217041 5.042381
##           Sep      Oct      Nov      Dec
## 2016                            4.477900
## 2017 4.824391 4.785977 4.735790</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="第五章作业.html#cb238-1" tabindex="-1"></a><span class="co"># 绘制原始数据和预测结果的图形</span></span>
<span id="cb238-2"><a href="第五章作业.html#cb238-2" tabindex="-1"></a><span class="fu">plot</span>(UnempRate, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;时间&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;销售量&quot;</span>, <span class="at">main =</span> <span class="st">&quot;UnempRate&quot;</span>)</span>
<span id="cb238-3"><a href="第五章作业.html#cb238-3" tabindex="-1"></a><span class="fu">lines</span>(UnempRate_forecast<span class="sc">$</span>pred, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb238-4"><a href="第五章作业.html#cb238-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;原始数据&quot;</span>, <span class="st">&quot;预测结果&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-105-1.png" width="672" /></p>
</div>
<div id="美国出生数据" class="section level2 hasAnchor" number="5.11">
<h2><span class="header-section-number">5.11</span> 5.11 美国出生数据<a href="第五章作业.html#美国出生数据" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>绘制时间序列的时序图，由于数据具有趋势性，考虑进行一次差分，差分后数据不再具有明显的趋势性。</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="第五章作业.html#cb239-1" tabindex="-1"></a><span class="fu">tsplot</span>(birth)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="第五章作业.html#cb240-1" tabindex="-1"></a><span class="fu">tsplot</span>(<span class="fu">diff</span>(birth))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-106-2.png" width="672" /></p>
<p>其次确定模型阶数：</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="第五章作业.html#cb241-1" tabindex="-1"></a><span class="fu">auto.arima</span>(birth)</span></code></pre></div>
<pre><code>## Series: birth 
## ARIMA(0,1,2)(1,1,1)[12] 
## 
## Coefficients:
##           ma1      ma2    sar1     sma1
##       -0.3984  -0.1632  0.1018  -0.8434
## s.e.   0.0512   0.0486  0.0713   0.0476
## 
## sigma^2 = 46.1:  log likelihood = -1204.93
## AIC=2419.86   AICc=2420.03   BIC=2439.29</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="第五章作业.html#cb243-1" tabindex="-1"></a><span class="fu">acf2</span>(<span class="fu">diff</span>(birth))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-107-1.png" width="672" /></p>
<pre><code>##       [,1] [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11] [,12]
## ACF  -0.32 0.16 -0.08 -0.19  0.09 -0.28  0.06 -0.19 -0.05  0.17 -0.26  0.82
## PACF -0.32 0.06 -0.01 -0.25 -0.03 -0.26 -0.17 -0.29 -0.35 -0.16 -0.59  0.57
##      [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24]
## ACF  -0.28  0.17 -0.07 -0.18  0.08 -0.28  0.07 -0.18 -0.05  0.16 -0.24  0.78
## PACF  0.13  0.11  0.13  0.09  0.00  0.00  0.05  0.04 -0.07 -0.10 -0.20  0.19
##      [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36]
## ACF  -0.27  0.19 -0.08 -0.17  0.07 -0.29  0.07 -0.15 -0.04  0.14 -0.24  0.75
## PACF  0.01  0.05  0.07  0.07 -0.02 -0.06 -0.02  0.09  0.03 -0.06 -0.16  0.03
##      [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44] [,45] [,46] [,47] [,48]
## ACF  -0.23  0.16 -0.08 -0.15  0.05 -0.25  0.06 -0.18 -0.03  0.15 -0.22  0.72
## PACF  0.08 -0.10 -0.03  0.07 -0.04  0.06  0.04 -0.07 -0.06  0.02 -0.04  0.10</code></pre>
<p>根据ACF、PACF的绘图结果，以及函数<code>auto.arima</code>得到的结果，可以选择模型为SARIMA(0,1,2,1,1,1)[12]，因此可以拟合模型并进行检验：</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="第五章作业.html#cb245-1" tabindex="-1"></a><span class="fu">sarima</span>(birth,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">12</span>)</span></code></pre></div>
<pre><code>## initial  value 2.221461 
## iter   2 value 1.995611
## iter   3 value 1.959402
## iter   4 value 1.936261
## iter   5 value 1.915351
## iter   6 value 1.912728
## iter   7 value 1.911791
## iter   8 value 1.911667
## iter   9 value 1.911654
## iter  10 value 1.911654
## iter  10 value 1.911654
## final  value 1.911654 
## converged
## initial  value 1.928810 
## iter   2 value 1.928320
## iter   3 value 1.928119
## iter   4 value 1.928103
## iter   5 value 1.928095
## iter   6 value 1.928094
## iter   7 value 1.928094
## iter   7 value 1.928094
## iter   7 value 1.928094
## final  value 1.928094 
## converged</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
##     include.mean = !no.constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
##         REPORT = 1, reltol = tol))
## 
## Coefficients:
##           ma1      ma2    sar1     sma1
##       -0.3984  -0.1632  0.1018  -0.8434
## s.e.   0.0512   0.0486  0.0713   0.0476
## 
## sigma^2 estimated as 45.58:  log likelihood = -1204.93,  aic = 2419.86
## 
## $degrees_of_freedom
## [1] 356
## 
## $ttable
##      Estimate     SE  t.value p.value
## ma1   -0.3984 0.0512  -7.7849  0.0000
## ma2   -0.1632 0.0486  -3.3599  0.0009
## sar1   0.1018 0.0713   1.4273  0.1544
## sma1  -0.8434 0.0476 -17.7108  0.0000
## 
## $AIC
## [1] 6.721842
## 
## $AICc
## [1] 6.722155
## 
## $BIC
## [1] 6.775816</code></pre>
<p>利用拟合的季节性ARIMA模型预测未来12个月的出生数据，并绘制在图中：</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="第五章作业.html#cb248-1" tabindex="-1"></a><span class="co"># 拟合ARIMA模型</span></span>
<span id="cb248-2"><a href="第五章作业.html#cb248-2" tabindex="-1"></a>birth_model <span class="ot">&lt;-</span> <span class="fu">arima</span>(birth, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb248-3"><a href="第五章作业.html#cb248-3" tabindex="-1"></a>                       <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">period =</span> <span class="dv">12</span>))</span>
<span id="cb248-4"><a href="第五章作业.html#cb248-4" tabindex="-1"></a></span>
<span id="cb248-5"><a href="第五章作业.html#cb248-5" tabindex="-1"></a><span class="co"># 对未来12个月进行预测</span></span>
<span id="cb248-6"><a href="第五章作业.html#cb248-6" tabindex="-1"></a>birth_forecast <span class="ot">&lt;-</span> <span class="fu">predict</span>(birth_model, <span class="at">n.ahead =</span> <span class="dv">12</span>)</span>
<span id="cb248-7"><a href="第五章作业.html#cb248-7" tabindex="-1"></a></span>
<span id="cb248-8"><a href="第五章作业.html#cb248-8" tabindex="-1"></a><span class="co"># 打印预测结果</span></span>
<span id="cb248-9"><a href="第五章作业.html#cb248-9" tabindex="-1"></a><span class="fu">print</span>(birth_forecast<span class="sc">$</span>pred)</span></code></pre></div>
<pre><code>##           Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
## 1979          258.2476 281.8175 263.3480 274.2731 270.5819 294.9579 302.9556
## 1980 275.9505                                                               
##           Sep      Oct      Nov      Dec
## 1979 295.8673 289.4151 273.2532 283.6455
## 1980</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="第五章作业.html#cb250-1" tabindex="-1"></a><span class="co"># 绘制原始数据和预测结果的图形</span></span>
<span id="cb250-2"><a href="第五章作业.html#cb250-2" tabindex="-1"></a><span class="fu">plot</span>(birth, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;时间&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;出生率&quot;</span>, <span class="at">main =</span> <span class="st">&quot;birth&quot;</span>)</span>
<span id="cb250-3"><a href="第五章作业.html#cb250-3" tabindex="-1"></a><span class="fu">lines</span>(birth_forecast<span class="sc">$</span>pred, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb250-4"><a href="第五章作业.html#cb250-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;原始数据&quot;</span>, <span class="st">&quot;预测结果&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>
</div>
<div id="强生公司收益率" class="section level2 hasAnchor" number="5.12">
<h2><span class="header-section-number">5.12</span> 5.12 强生公司收益率<a href="第五章作业.html#强生公司收益率" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>绘制时间序列的时序图，由于数据具有趋势性，考虑进行一次差分，差分后数据不再具有明显的趋势性。</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="第五章作业.html#cb251-1" tabindex="-1"></a><span class="fu">tsplot</span>(<span class="fu">log</span>(jj))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="第五章作业.html#cb252-1" tabindex="-1"></a><span class="fu">tsplot</span>(<span class="fu">diff</span>(<span class="fu">log</span>(jj)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-110-2.png" width="672" /></p>
<p>其次确定模型阶数：</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="第五章作业.html#cb253-1" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">log</span>(jj))</span></code></pre></div>
<pre><code>## Series: log(jj) 
## ARIMA(2,0,0)(1,1,0)[4] with drift 
## 
## Coefficients:
##          ar1     ar2     sar1   drift
##       0.2686  0.2855  -0.2695  0.0382
## s.e.  0.1137  0.1214   0.1212  0.0042
## 
## sigma^2 = 0.007793:  log likelihood = 82.47
## AIC=-154.95   AICc=-154.14   BIC=-143.04</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="第五章作业.html#cb255-1" tabindex="-1"></a><span class="fu">acf2</span>(<span class="fu">diff</span>(<span class="fu">log</span>(jj)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
<pre><code>##       [,1]  [,2] [,3] [,4]  [,5]  [,6]  [,7] [,8]  [,9] [,10] [,11] [,12] [,13]
## ACF  -0.51  0.07 -0.4 0.73 -0.37  0.00 -0.25 0.56 -0.28 -0.01 -0.22  0.45 -0.21
## PACF -0.51 -0.26 -0.7 0.27  0.16 -0.11 -0.01 0.11  0.05  0.12 -0.03 -0.03  0.04
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20]
## ACF  -0.04 -0.15  0.35 -0.14 -0.08 -0.09  0.27
## PACF -0.08 -0.04 -0.04 -0.04 -0.06 -0.02  0.01</code></pre>
<p>根据ACF、PACF的绘图结果，以及函数<code>auto.arima</code>得到的结果，可以选择模型为SARIMA(2,2,0,1,1,0)[4]，因此可以拟合模型并进行检验：</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="第五章作业.html#cb257-1" tabindex="-1"></a><span class="fu">sarima</span>(<span class="fu">log</span>(jj),<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## initial  value -2.405347 
## iter   2 value -2.484501
## iter   3 value -2.497205
## iter   4 value -2.498334
## iter   5 value -2.498401
## iter   6 value -2.498403
## iter   7 value -2.498403
## iter   7 value -2.498403
## iter   7 value -2.498403
## final  value -2.498403 
## converged
## initial  value -2.446934 
## iter   2 value -2.449248
## iter   3 value -2.449834
## iter   4 value -2.449862
## iter   5 value -2.449866
## iter   6 value -2.449866
## iter   7 value -2.449866
## iter   7 value -2.449866
## iter   7 value -2.449866
## final  value -2.449866 
## converged</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
<pre><code>## $fit
## 
## Call:
## arima(x = xdata, order = c(p, d, q), seasonal = list(order = c(P, D, Q), period = S), 
##     xreg = constant, transform.pars = trans, fixed = fixed, optim.control = list(trace = trc, 
##         REPORT = 1, reltol = tol))
## 
## Coefficients:
##          ar1     ar2     sar1  constant
##       0.2686  0.2855  -0.2695    0.0382
## s.e.  0.1137  0.1214   0.1212    0.0042
## 
## sigma^2 estimated as 0.007403:  log likelihood = 82.47,  aic = -154.95
## 
## $degrees_of_freedom
## [1] 76
## 
## $ttable
##          Estimate     SE t.value p.value
## ar1        0.2686 0.1137  2.3616  0.0208
## ar2        0.2855 0.1214  2.3516  0.0213
## sar1      -0.2695 0.1212 -2.2236  0.0291
## constant   0.0382 0.0042  8.9990  0.0000
## 
## $AIC
## [1] -1.936856
## 
## $AICc
## [1] -1.930189
## 
## $BIC
## [1] -1.787979</code></pre>
<p>利用拟合的季节性ARIMA模型预测未来4个季度的收益率，并绘制在图中：</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="第五章作业.html#cb260-1" tabindex="-1"></a><span class="co"># 拟合ARIMA模型</span></span>
<span id="cb260-2"><a href="第五章作业.html#cb260-2" tabindex="-1"></a>logjj_model <span class="ot">&lt;-</span> <span class="fu">arima</span>(<span class="fu">log</span>(jj), <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>),</span>
<span id="cb260-3"><a href="第五章作业.html#cb260-3" tabindex="-1"></a>                       <span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">period =</span> <span class="dv">4</span>))</span>
<span id="cb260-4"><a href="第五章作业.html#cb260-4" tabindex="-1"></a></span>
<span id="cb260-5"><a href="第五章作业.html#cb260-5" tabindex="-1"></a><span class="co"># 对未来12个月进行预测</span></span>
<span id="cb260-6"><a href="第五章作业.html#cb260-6" tabindex="-1"></a>logjj_forecast <span class="ot">&lt;-</span> <span class="fu">predict</span>(logjj_model, <span class="at">n.ahead =</span> <span class="dv">4</span>)</span>
<span id="cb260-7"><a href="第五章作业.html#cb260-7" tabindex="-1"></a></span>
<span id="cb260-8"><a href="第五章作业.html#cb260-8" tabindex="-1"></a><span class="co"># 打印预测结果</span></span>
<span id="cb260-9"><a href="第五章作业.html#cb260-9" tabindex="-1"></a><span class="fu">print</span>(logjj_forecast<span class="sc">$</span>pred)</span></code></pre></div>
<pre><code>##          Qtr1     Qtr2     Qtr3     Qtr4
## 1981 2.900503 2.830641 2.933700 2.600540</code></pre>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="第五章作业.html#cb262-1" tabindex="-1"></a><span class="co"># 绘制原始数据和预测结果的图形</span></span>
<span id="cb262-2"><a href="第五章作业.html#cb262-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(jj), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;时间&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;收益率&quot;</span>, <span class="at">main =</span> <span class="st">&quot;jj&quot;</span>)</span>
<span id="cb262-3"><a href="第五章作业.html#cb262-3" tabindex="-1"></a><span class="fu">lines</span>(logjj_forecast<span class="sc">$</span>pred, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb262-4"><a href="第五章作业.html#cb262-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;原始数据&quot;</span>, <span class="st">&quot;预测结果&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="第四章作业.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-时间序列第五次作业.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
